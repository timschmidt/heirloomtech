

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_a5de7543e32a5f073daa04f8834eb5fd.html">cpu</a>      </li>
      <li class="navelem"><a class="el" href="dir_3ade2df878d06c00b7da75ebdc1e74f5.html">arm</a>      </li>
      <li class="navelem"><a class="el" href="dir_88b011769bd68bcbdcfc8a5f3d937253.html">drv</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stepper_at91.c File Reference</div>  </div>
</div>
<div class="contents">

<p><a class="el" href="structStepper.html" title="Motor context structure.">Stepper</a> driver interface implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="stepper__at91_8h_source.html">stepper_at91.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cfg__stepper_8h_source.html">cfg/cfg_stepper.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="macros_8h_source.html">cfg/macros.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="debug_8h_source.html">cfg/debug.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="types_8h_source.html">cpu/types.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="cpu_2irq_8h_source.html">cpu/irq.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="arm_8h_source.html">io/arm.h</a>&gt;</code><br/>
</div>
<p><a href="stepper__at91_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4802c4af314569d379b41482f5f6ab0d"></a><!-- doxytag: member="stepper_at91.c::ISR_PROTO" ref="a4802c4af314569d379b41482f5f6ab0d" args="(stepper_tc2_irq)" -->
static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper__at91_8c.html#a4802c4af314569d379b41482f5f6ab0d">ISR_PROTO</a> (stepper_tc2_irq)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Static array of timer counter struct for stepper. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aac4921d5bec26f326d54aa15c81f9e30"></a><!-- doxytag: member="stepper_at91.c::stepper_tc_tio_irq" ref="aac4921d5bec26f326d54aa15c81f9e30" args="(struct TimerCounter *t)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper__at91_8c.html#aac4921d5bec26f326d54aa15c81f9e30">stepper_tc_tio_irq</a> (struct <a class="el" href="structTimerCounter.html">TimerCounter</a> *t)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic TIO interrupt handler. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper__at91_8c.html#ac7bc4b0c0ed7b49d880c0d53d3116188">stepper_tc_setup</a> (int index, <a class="el" href="stepper_8h.html#a64acd423c9f0e2216991f2f4c3485af3">stepper_isr_t</a> callback, struct <a class="el" href="structStepper.html">Stepper</a> *motor)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structTimer.html" title="The timer driver supports multiple synchronous timers that can trigger an event when they expire...">Timer</a> couter setup.  <a href="#ac7bc4b0c0ed7b49d880c0d53d3116188"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac7283f5e3fd3758df32d2c894832f571"></a><!-- doxytag: member="stepper_at91.c::stepper_tc_init" ref="ac7283f5e3fd3758df32d2c894832f571" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stepper__at91_8c.html#ac7283f5e3fd3758df32d2c894832f571">stepper_tc_init</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structTimer.html" title="The timer driver supports multiple synchronous timers that can trigger an event when they expire...">Timer</a> counter init. <br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p><a class="el" href="structStepper.html" title="Motor context structure.">Stepper</a> driver interface implementation. </p>
<p>This module use the three timer on the at91 family, to generate a six periodic variable pwm waveform. The pulse width is fix, and could change by setting the STEPPER_DELAY_ON_COMPARE_C define, but you make an attention to do this, becouse the pulse width is not exactly STEPPER_DELAY_ON_COMPARE_C. The pulse width depend also to latency time of cpu to serve an interrupt, this generate an pwm waveform affect to noise. This noise not effect the period but only the pulse width, becouse the raising edge is generate by hardware comply with the our period settings.</p>
<p>Note: is most important to set STEPPER_DELAY_ON_COMPARE_C value minor than a interrupt time service, becouse the falling edge must be happen inside to inerrupt service to guarantee a correct functionaly of pwm generator.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Daniele Basile &lt;<a href="mailto:asterix@develer.com">asterix@develer.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="stepper__at91_8c_source.html">stepper_at91.c</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac7bc4b0c0ed7b49d880c0d53d3116188"></a><!-- doxytag: member="stepper_at91.c::stepper_tc_setup" ref="ac7bc4b0c0ed7b49d880c0d53d3116188" args="(int index, stepper_isr_t callback, struct Stepper *motor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stepper_tc_setup </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stepper_8h.html#a64acd423c9f0e2216991f2f4c3485af3">stepper_isr_t</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structStepper.html">Stepper</a> *&#160;</td>
          <td class="paramname"><em>motor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="structTimer.html" title="The timer driver supports multiple synchronous timers that can trigger an event when they expire...">Timer</a> couter setup. </p>
<p>This function apply to select timer couter all needed settings. Every settings are stored in stepper_timers[]. </p>

<p>Definition at line <a class="el" href="stepper__at91_8c_source.html#l00332">332</a> of file <a class="el" href="stepper__at91_8c_source.html">stepper_at91.c</a>.</p>

</div>
</div>
</div>


