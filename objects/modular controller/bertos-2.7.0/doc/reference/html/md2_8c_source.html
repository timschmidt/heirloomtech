

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_7a1c32e0b61e66bba4924a9a48a40b57.html">algo</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">md2.c</div>  </div>
</div>
<div class="contents">
<a href="md2_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="md2_8h.html" title="MD2 Message-Digest algorithm.">md2.h</a>&quot;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;string.h&gt;</span>           <span class="comment">//memset(), memcpy();</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;<a class="code" href="compiler_8h.html" title="Additional support macros for compiler independance.">cfg/compiler.h</a>&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;<a class="code" href="debug_8h.html">cfg/debug.h</a>&gt;</span>        <span class="comment">//ASSERT()</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;<a class="code" href="macros_8h.html">cfg/macros.h</a>&gt;</span>       <span class="comment">//MIN(), countof(), ROTR();</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &lt;<a class="code" href="cpu_2pgm_8h.html" title="Support for reading program memory on Harvard architectures.">cpu/pgm.h</a>&gt;</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="preprocessor">#if CONFIG_MD2_STD_PERM</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span>    <span class="comment">/*</span>
<a name="l00059"></a>00059 <span class="comment">    * Official array of 256 byte pemutation contructed from digits of pi, defined</span>
<a name="l00060"></a>00060 <span class="comment">    * in the RFC 1319.</span>
<a name="l00061"></a>00061 <span class="comment">    */</span>
<a name="l00062"></a>00062     <span class="keyword">static</span> <span class="keyword">const</span> uint8_t PROGMEM md2_perm[256] =
<a name="l00063"></a>00063     {
<a name="l00064"></a>00064     41, 46, 67, 201, 162, 216, 124, 1, 61, 54, 84, 161, 236, 240, 6,
<a name="l00065"></a>00065     19, 98, 167, 5, 243, 192, 199, 115, 140, 152, 147, 43, 217, 188,
<a name="l00066"></a>00066     76, 130, 202, 30, 155, 87, 60, 253, 212, 224, 22, 103, 66, 111, 24,
<a name="l00067"></a>00067     138, 23, 229, 18, 190, 78, 196, 214, 218, 158, 222, 73, 160, 251,
<a name="l00068"></a>00068     245, 142, 187, 47, 238, 122, 169, 104, 121, 145, 21, 178, 7, 63,
<a name="l00069"></a>00069     148, 194, 16, 137, 11, 34, 95, 33, 128, 127, 93, 154, 90, 144, 50,
<a name="l00070"></a>00070     39, 53, 62, 204, 231, 191, 247, 151, 3, 255, 25, 48, 179, 72, 165,
<a name="l00071"></a>00071     181, 209, 215, 94, 146, 42, 172, 86, 170, 198, 79, 184, 56, 210,
<a name="l00072"></a>00072     150, 164, 125, 182, 118, 252, 107, 226, 156, 116, 4, 241, 69, 157,
<a name="l00073"></a>00073     112, 89, 100, 113, 135, 32, 134, 91, 207, 101, 230, 45, 168, 2, 27,
<a name="l00074"></a>00074     96, 37, 173, 174, 176, 185, 246, 28, 70, 97, 105, 52, 64, 126, 15,
<a name="l00075"></a>00075     85, 71, 163, 35, 221, 81, 175, 58, 195, 92, 249, 206, 186, 197,
<a name="l00076"></a>00076     234, 38, 44, 83, 13, 110, 133, 40, 132, 9, 211, 223, 205, 244, 65,
<a name="l00077"></a>00077     129, 77, 82, 106, 220, 55, 200, 108, 193, 171, 250, 36, 225, 123,
<a name="l00078"></a>00078     8, 12, 189, 177, 74, 120, 136, 149, 139, 227, 99, 232, 109, 233,
<a name="l00079"></a>00079     203, 213, 254, 59, 0, 29, 57, 242, 239, 183, 14, 102, 88, 208, 228,
<a name="l00080"></a>00080     166, 119, 114, 248, 235, 117, 75, 10, 49, 68, 80, 180, 143, 237,
<a name="l00081"></a>00081     31, 26, 219, 153, 141, 51, 159, 17, 131, 20
<a name="l00082"></a>00082     };
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="preprocessor">    #define MD2_PERM(x) pgm_read8(&amp;md2_perm[x])</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span>
<a name="l00094"></a><a class="code" href="md2_8c.html#aadecb1977e30da2f62766f1fcb8b1f95">00094</a> <span class="preprocessor">    #define K1 5</span>
<a name="l00095"></a><a class="code" href="md2_8c.html#ab6d0e745059aded06587e4b6933bca0b">00095</a> <span class="preprocessor"></span><span class="preprocessor">    #define K2 3</span>
<a name="l00096"></a><a class="code" href="md2_8c.html#a5c71a5e59a53413cd6c270266d63b031">00096</a> <span class="preprocessor"></span><span class="preprocessor">    #define R  2</span>
<a name="l00097"></a><a class="code" href="md2_8c.html#a207fd5507206d307cd63f95374fcd00d">00097</a> <span class="preprocessor"></span><span class="preprocessor">    #define X  172</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>    <span class="comment">/*\}*/</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100     <span class="keyword">static</span> uint8_t md2_perm(uint8_t i)
<a name="l00101"></a>00101     {
<a name="l00102"></a>00102 
<a name="l00103"></a>00103         i = i * <a class="code" href="md2_8c.html#aadecb1977e30da2f62766f1fcb8b1f95" title="Md2_perm() function generate an array of 256 &quot;casual&quot; permutation.">K1</a>;
<a name="l00104"></a>00104         i = <a class="code" href="group__macros.html#gad14c19eb02ca88957d5dca2d84681cc6" title="Macro for rotating bit left or right.">ROTR</a>(i, <a class="code" href="md2_8c.html#a5c71a5e59a53413cd6c270266d63b031" title="Md2_perm() function generate an array of 256 &quot;casual&quot; permutation.">R</a>);
<a name="l00105"></a>00105         i ^=  <a class="code" href="md2_8c.html#a207fd5507206d307cd63f95374fcd00d" title="Md2_perm() function generate an array of 256 &quot;casual&quot; permutation.">X</a>;
<a name="l00106"></a>00106         i = i * <a class="code" href="md2_8c.html#ab6d0e745059aded06587e4b6933bca0b" title="Md2_perm() function generate an array of 256 &quot;casual&quot; permutation.">K2</a>;
<a name="l00107"></a>00107 
<a name="l00108"></a>00108         <span class="keywordflow">return</span> i;
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="preprocessor">    #define MD2_PERM(x) md2_perm(x)</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span>
<a name="l00113"></a>00113 <span class="preprocessor">#endif</span>
<a name="l00114"></a>00114 <span class="preprocessor"></span>
<a name="l00115"></a>00115 
<a name="l00120"></a><a class="code" href="md2_8c.html#a0df28f09f3a3e4253fc944605697319c">00120</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="md2_8c.html#a0df28f09f3a3e4253fc944605697319c" title="Pad function.">md2_pad</a>(<span class="keywordtype">void</span> *_block, <span class="keywordtype">size_t</span> len_pad)
<a name="l00121"></a>00121 {
<a name="l00122"></a>00122     uint8_t *block;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     block = (uint8_t *)_block;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     <a class="code" href="group__debug.html#gaca68c0d4ac8df0838e209fb5300f7be3" title="Assert a pre-condition on code.">ASSERT</a>(len_pad &lt;= <a class="code" href="cfg__md2_8h.html#af7d072f05d0fb21d9e99fe5fc58c9c3a" title="Size of block for MD2 algorithm.">CONFIG_MD2_BLOCK_LEN</a>);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <span class="comment">/*</span>
<a name="l00129"></a>00129 <span class="comment">     * Fill input block with len_pad char.</span>
<a name="l00130"></a>00130 <span class="comment">     */</span>
<a name="l00131"></a>00131     memset(block, len_pad, len_pad);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 <span class="keyword">static</span> <span class="keywordtype">void</span> md2_compute(<span class="keywordtype">void</span> *_state, <span class="keywordtype">void</span> *_checksum, <span class="keywordtype">void</span> *_block)
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137     <span class="keywordtype">int</span> i = 0;
<a name="l00138"></a>00138     uint16_t t = 0;
<a name="l00139"></a>00139     uint8_t compute_array[<a class="code" href="md2_8h.html#a22629b43528720d69cc41ffe622a11bb" title="Lenght of compute array.">COMPUTE_ARRAY_LEN</a>];
<a name="l00140"></a>00140     uint8_t *state;
<a name="l00141"></a>00141     uint8_t *checksum;
<a name="l00142"></a>00142     uint8_t *block;
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     state = (uint8_t *)_state;
<a name="l00145"></a>00145     checksum  = (uint8_t *)_checksum;
<a name="l00146"></a>00146     block = (uint8_t *)_block;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="comment">/*</span>
<a name="l00149"></a>00149 <span class="comment">     * Copy state and checksum context in compute array.</span>
<a name="l00150"></a>00150 <span class="comment">     */</span>
<a name="l00151"></a>00151     memcpy(compute_array, state, <a class="code" href="cfg__md2_8h.html#af7d072f05d0fb21d9e99fe5fc58c9c3a" title="Size of block for MD2 algorithm.">CONFIG_MD2_BLOCK_LEN</a>);
<a name="l00152"></a>00152     memcpy(compute_array + <a class="code" href="cfg__md2_8h.html#af7d072f05d0fb21d9e99fe5fc58c9c3a" title="Size of block for MD2 algorithm.">CONFIG_MD2_BLOCK_LEN</a>, block, <a class="code" href="cfg__md2_8h.html#af7d072f05d0fb21d9e99fe5fc58c9c3a" title="Size of block for MD2 algorithm.">CONFIG_MD2_BLOCK_LEN</a>);
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <span class="comment">/*</span>
<a name="l00155"></a>00155 <span class="comment">     * Fill compute array with state XOR block</span>
<a name="l00156"></a>00156 <span class="comment">     */</span>
<a name="l00157"></a>00157     <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="cfg__md2_8h.html#af7d072f05d0fb21d9e99fe5fc58c9c3a" title="Size of block for MD2 algorithm.">CONFIG_MD2_BLOCK_LEN</a>; i++)
<a name="l00158"></a>00158         compute_array[i + (CONFIG_MD2_BLOCK_LEN * 2)] = state[i] ^ block[i];
<a name="l00159"></a>00159 
<a name="l00160"></a>00160     <span class="comment">/*</span>
<a name="l00161"></a>00161 <span class="comment">     * Encryt block.</span>
<a name="l00162"></a>00162 <span class="comment">     */</span>
<a name="l00163"></a>00163     <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="md2_8h.html#a5c5e719a7f16bc0129d1136b55d463d8" title="Number of compute rounds.">NUM_COMPUTE_ROUNDS</a>; i++)
<a name="l00164"></a>00164     {
<a name="l00165"></a>00165         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="md2_8h.html#a22629b43528720d69cc41ffe622a11bb" title="Lenght of compute array.">COMPUTE_ARRAY_LEN</a>; j++)
<a name="l00166"></a>00166         {
<a name="l00167"></a>00167             compute_array[j] ^= MD2_PERM(t);
<a name="l00168"></a>00168             t = compute_array[j];
<a name="l00169"></a>00169         }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171         t = (t + i) &amp; 0xff; <span class="comment">//modulo 256.</span>
<a name="l00172"></a>00172     }
<a name="l00173"></a>00173     <span class="comment">/*</span>
<a name="l00174"></a>00174 <span class="comment">     * Update checksum.</span>
<a name="l00175"></a>00175 <span class="comment">     */</span>
<a name="l00176"></a>00176     t = checksum[CONFIG_MD2_BLOCK_LEN - 1];
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="cfg__md2_8h.html#af7d072f05d0fb21d9e99fe5fc58c9c3a" title="Size of block for MD2 algorithm.">CONFIG_MD2_BLOCK_LEN</a>; i++)
<a name="l00179"></a>00179     {
<a name="l00180"></a>00180         checksum[i]  ^= MD2_PERM(block[i] ^ t);
<a name="l00181"></a>00181         t = checksum[i];
<a name="l00182"></a>00182     }
<a name="l00183"></a>00183 
<a name="l00184"></a>00184     <span class="comment">/*</span>
<a name="l00185"></a>00185 <span class="comment">     * Update state and clean compute array.</span>
<a name="l00186"></a>00186 <span class="comment">     */</span>
<a name="l00187"></a>00187     memcpy(state, compute_array, CONFIG_MD2_BLOCK_LEN);
<a name="l00188"></a>00188     memset(compute_array, 0, <span class="keyword">sizeof</span>(compute_array));
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00196"></a><a class="code" href="md2_8h.html#a6aa016e9ff54a4a86d52aa1229e4880b">00196</a> <span class="keywordtype">void</span> <a class="code" href="md2_8c.html#a6aa016e9ff54a4a86d52aa1229e4880b" title="Algorithm initialization.">md2_init</a>(<a class="code" href="structMd2Context.html" title="Context for MD2 computation.">Md2Context</a> *context)
<a name="l00197"></a>00197 {
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     memset(context, 0, <span class="keyword">sizeof</span>(<a class="code" href="structMd2Context.html" title="Context for MD2 computation.">Md2Context</a>));
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00206"></a><a class="code" href="md2_8h.html#a7f16487642f7baad9b3c307715a63a0e">00206</a> <span class="keywordtype">void</span> <a class="code" href="md2_8c.html#ab065e8d81c047f6452cfb28cb7275288" title="Update block.">md2_update</a>(<a class="code" href="structMd2Context.html" title="Context for MD2 computation.">Md2Context</a> *context, <span class="keyword">const</span> <span class="keywordtype">void</span> *_block_in, <span class="keywordtype">size_t</span> block_len)
<a name="l00207"></a>00207 {
<a name="l00208"></a>00208 
<a name="l00209"></a>00209     <span class="keyword">const</span> uint8_t *block_in;
<a name="l00210"></a>00210     <span class="keywordtype">size_t</span> cpy_len;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     block_in = (<span class="keyword">const</span> uint8_t *)_block_in;
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="keywordflow">while</span>(block_len &gt; 0)
<a name="l00216"></a>00216     {
<a name="l00217"></a>00217         <span class="comment">/*</span>
<a name="l00218"></a>00218 <span class="comment">         * Choose a number of block that fill input context buffer.</span>
<a name="l00219"></a>00219 <span class="comment">         */</span>
<a name="l00220"></a>00220         cpy_len = MIN(block_len, CONFIG_MD2_BLOCK_LEN - context-&gt;<a class="code" href="structMd2Context.html#af8caa4cf3769eab11bb16142a456d713" title="Counter of remaining bytes.">counter</a>);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 
<a name="l00223"></a>00223         <span class="comment">/*</span>
<a name="l00224"></a>00224 <span class="comment">         * Copy in the buffer input block.</span>
<a name="l00225"></a>00225 <span class="comment">         */</span>
<a name="l00226"></a>00226         memcpy(&amp;context-&gt;<a class="code" href="structMd2Context.html#a3a399a86a6b9d0b03aa71b8830cd7a79" title="Input buffer.">buffer</a>[context-&gt;<a class="code" href="structMd2Context.html#af8caa4cf3769eab11bb16142a456d713" title="Counter of remaining bytes.">counter</a>], block_in, cpy_len);
<a name="l00227"></a>00227 
<a name="l00228"></a>00228         <span class="comment">/*</span>
<a name="l00229"></a>00229 <span class="comment">         * Update a context counter, input block length and remaning</span>
<a name="l00230"></a>00230 <span class="comment">         * context buffer block lenght.</span>
<a name="l00231"></a>00231 <span class="comment">         */</span>
<a name="l00232"></a>00232         context-&gt;<a class="code" href="structMd2Context.html#af8caa4cf3769eab11bb16142a456d713" title="Counter of remaining bytes.">counter</a> += cpy_len;
<a name="l00233"></a>00233         block_len -= cpy_len;
<a name="l00234"></a>00234         block_in += cpy_len;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236         <span class="comment">/*</span>
<a name="l00237"></a>00237 <span class="comment">         * If buffer is full, compute it.</span>
<a name="l00238"></a>00238 <span class="comment">         */</span>
<a name="l00239"></a>00239         <span class="keywordflow">if</span> (context-&gt;<a class="code" href="structMd2Context.html#af8caa4cf3769eab11bb16142a456d713" title="Counter of remaining bytes.">counter</a> &gt;= CONFIG_MD2_BLOCK_LEN)
<a name="l00240"></a>00240         {
<a name="l00241"></a>00241             md2_compute(context-&gt;<a class="code" href="structMd2Context.html#aaf3f32ce349aa8dc5ad5e38830043967" title="Current state buffer.">state</a>, context-&gt;<a class="code" href="structMd2Context.html#ab93d2147b3ec3bb3c3eb7a1047592902" title="Checksum.">checksum</a>, context-&gt;<a class="code" href="structMd2Context.html#a3a399a86a6b9d0b03aa71b8830cd7a79" title="Input buffer.">buffer</a>);
<a name="l00242"></a>00242             context-&gt;<a class="code" href="structMd2Context.html#af8caa4cf3769eab11bb16142a456d713" title="Counter of remaining bytes.">counter</a> = 0;
<a name="l00243"></a>00243         }
<a name="l00244"></a>00244     }
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 }
<a name="l00256"></a><a class="code" href="md2_8h.html#a65b7978fdab3a8da0dc1ca4d0d896da5">00256</a> uint8_t  *<a class="code" href="md2_8c.html#a65b7978fdab3a8da0dc1ca4d0d896da5" title="Ends an MD2 message digest operation.">md2_end</a>(<a class="code" href="structMd2Context.html" title="Context for MD2 computation.">Md2Context</a> *context)
<a name="l00257"></a>00257 {
<a name="l00258"></a>00258 
<a name="l00259"></a>00259     uint8_t buf[<a class="code" href="cfg__md2_8h.html#af7d072f05d0fb21d9e99fe5fc58c9c3a" title="Size of block for MD2 algorithm.">CONFIG_MD2_BLOCK_LEN</a>];
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <span class="comment">/*</span>
<a name="l00262"></a>00262 <span class="comment">     * Fill remaning empty context buffer.</span>
<a name="l00263"></a>00263 <span class="comment">     */</span>
<a name="l00264"></a>00264     <a class="code" href="md2_8c.html#a0df28f09f3a3e4253fc944605697319c" title="Pad function.">md2_pad</a>(buf, CONFIG_MD2_BLOCK_LEN - context-&gt;<a class="code" href="structMd2Context.html#af8caa4cf3769eab11bb16142a456d713" title="Counter of remaining bytes.">counter</a>);
<a name="l00265"></a>00265 
<a name="l00266"></a>00266     <span class="comment">/*</span>
<a name="l00267"></a>00267 <span class="comment">     * Update context buffer and compute it.</span>
<a name="l00268"></a>00268 <span class="comment">     */</span>
<a name="l00269"></a>00269     <a class="code" href="md2_8c.html#ab065e8d81c047f6452cfb28cb7275288" title="Update block.">md2_update</a>(context, buf, CONFIG_MD2_BLOCK_LEN - context-&gt;<a class="code" href="structMd2Context.html#af8caa4cf3769eab11bb16142a456d713" title="Counter of remaining bytes.">counter</a>);
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="comment">/*</span>
<a name="l00272"></a>00272 <span class="comment">     * Add context checksum to message input.</span>
<a name="l00273"></a>00273 <span class="comment">     */</span>
<a name="l00274"></a>00274     <a class="code" href="md2_8c.html#ab065e8d81c047f6452cfb28cb7275288" title="Update block.">md2_update</a>(context, context-&gt;<a class="code" href="structMd2Context.html#ab93d2147b3ec3bb3c3eb7a1047592902" title="Checksum.">checksum</a>, CONFIG_MD2_BLOCK_LEN);
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 
<a name="l00277"></a>00277     <span class="keywordflow">return</span> context-&gt;<a class="code" href="structMd2Context.html#aaf3f32ce349aa8dc5ad5e38830043967" title="Current state buffer.">state</a>; <span class="comment">//return a pointer to message digest.</span>
<a name="l00278"></a>00278 }
<a name="l00288"></a><a class="code" href="md2_8h.html#a6798ac8155afab2f14fe5aa2147eb862">00288</a> <span class="keywordtype">bool</span> <a class="code" href="md2_8c.html#a6798ac8155afab2f14fe5aa2147eb862" title="MD2 test fuction.">md2_test</a>(<span class="keywordtype">void</span>)
<a name="l00289"></a>00289 {
<a name="l00290"></a>00290 
<a name="l00291"></a>00291     <a class="code" href="structMd2Context.html" title="Context for MD2 computation.">Md2Context</a> context;
<a name="l00292"></a>00292 
<a name="l00293"></a>00293     <span class="keyword">const</span> <span class="keywordtype">char</span> *test[] =
<a name="l00294"></a>00294     {
<a name="l00295"></a>00295         <span class="stringliteral">&quot;&quot;</span>,
<a name="l00296"></a>00296         <span class="stringliteral">&quot;message digest&quot;</span>,
<a name="l00297"></a>00297         <span class="stringliteral">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span>,
<a name="l00298"></a>00298         <span class="stringliteral">&quot;12345678901234567890123456789012345678901234567890123456789012345678901234567890&quot;</span>
<a name="l00299"></a>00299     };
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 
<a name="l00302"></a>00302     <span class="keyword">const</span> <span class="keywordtype">char</span> *result[] = {
<a name="l00303"></a>00303         <span class="stringliteral">&quot;\x83\x50\xe5\xa3\xe2\x4c\x15\x3d\xf2\x27\x5c\x9f\x80\x69\x27\x73&quot;</span>,
<a name="l00304"></a>00304         <span class="stringliteral">&quot;\xab\x4f\x49\x6b\xfb\x2a\x53\x0b\x21\x9f\xf3\x30\x31\xfe\x06\xb0&quot;</span>,
<a name="l00305"></a>00305         <span class="stringliteral">&quot;\x4e\x8d\xdf\xf3\x65\x02\x92\xab\x5a\x41\x08\xc3\xaa\x47\x94\x0b&quot;</span>,
<a name="l00306"></a>00306         <span class="stringliteral">&quot;\xd5\x97\x6f\x79\xd8\x3d\x3a\x0d\xc9\x80\x6c\x3c\x66\xf3\xef\xd8&quot;</span>,
<a name="l00307"></a>00307     };
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="compiler_8h.html#a3c5cd622462bb50b6dab4c189e219eb9" title="Count the number of elements in the static array a.">countof</a>(test); i++)
<a name="l00311"></a>00311     {
<a name="l00312"></a>00312         <a class="code" href="md2_8c.html#a6aa016e9ff54a4a86d52aa1229e4880b" title="Algorithm initialization.">md2_init</a>(&amp;context);
<a name="l00313"></a>00313         <a class="code" href="md2_8c.html#ab065e8d81c047f6452cfb28cb7275288" title="Update block.">md2_update</a>(&amp;context, test[i], strlen(test[i]));
<a name="l00314"></a>00314 
<a name="l00315"></a>00315         <span class="keywordflow">if</span>(memcmp(result[i], <a class="code" href="md2_8c.html#a65b7978fdab3a8da0dc1ca4d0d896da5" title="Ends an MD2 message digest operation.">md2_end</a>(&amp;context), MD2_DIGEST_LEN))
<a name="l00316"></a>00316             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318 
<a name="l00319"></a>00319     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 <span class="preprocessor">#if 0</span>
<a name="l00323"></a>00323 <span class="preprocessor"></span>
<a name="l00324"></a>00324 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00325"></a>00325 <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * argv[])
<a name="l00326"></a>00326 {
<a name="l00327"></a>00327 
<a name="l00328"></a>00328     <span class="keywordflow">if</span>(<a class="code" href="md2_8c.html#a6798ac8155afab2f14fe5aa2147eb862" title="MD2 test fuction.">md2_test</a>())
<a name="l00329"></a>00329         printf(<span class="stringliteral">&quot;MD2 algorithm work well!\n&quot;</span>);
<a name="l00330"></a>00330     <span class="keywordflow">else</span>
<a name="l00331"></a>00331         printf(<span class="stringliteral">&quot;MD2 algorithm doesn&#39;t work well.\n&quot;</span>);
<a name="l00332"></a>00332 
<a name="l00333"></a>00333 }
<a name="l00334"></a>00334 
<a name="l00335"></a>00335 <span class="preprocessor">#endif</span>
<a name="l00336"></a>00336 <span class="preprocessor"></span>
</pre></div></div>
</div>


