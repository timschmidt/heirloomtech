

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_e91c80130e425b11d52da5b92a7aa933.html">net</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">afsk.c File Reference</div>  </div>
</div>
<div class="contents">

<p>AFSK1200 modem.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="afsk_8h_source.html">afsk.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="ax25_8h_source.html">net/ax25.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="cfg__afsk_8h_source.html">cfg/cfg_afsk.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="hw__afsk_8h_source.html">hw/hw_afsk.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="timer_8h_source.html">drv/timer.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="module_8h_source.html">cfg/module.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="log_8h_source.html">cfg/log.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="power_8h_source.html">cpu/power.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="cpu_2pgm_8h_source.html">cpu/pgm.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="fifobuf_8h_source.html">struct/fifobuf.h</a>&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
</div>
<p><a href="afsk_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa905e754cc59c8a38f5c75127514e77a"></a><!-- doxytag: member="afsk.c::SIN_LEN" ref="aa905e754cc59c8a38f5c75127514e77a" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="afsk_8c.html#aa905e754cc59c8a38f5c75127514e77a">SIN_LEN</a>&#160;&#160;&#160;512</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Full wave length. <br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae42717b419eb5a1f1688101cecba3943"></a><!-- doxytag: member="afsk.c::sin_sample" ref="ae42717b419eb5a1f1688101cecba3943" args="(uint16_t idx)" -->
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="afsk_8c.html#ae42717b419eb5a1f1688101cecba3943">sin_sample</a> (uint16_t idx)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Given the index, this function computes the correct sine sample based only on the first quarter of wave. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="afsk_8c.html#a7f23d9977de50b84502f6847da998058">hdlc_parse</a> (<a class="el" href="structHdlc.html">Hdlc</a> *hdlc, bool bit, FIFOBuffer *fifo)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">High-Level Data Link Control parsing function.  <a href="#a7f23d9977de50b84502f6847da998058"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="afsk_8c.html#a6e7a76ef4090f84faef32c36d5212818">afsk_adc_isr</a> (<a class="el" href="structAfsk.html">Afsk</a> *af, int8_t curr_sample)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">ADC ISR callback.  <a href="#a6e7a76ef4090f84faef32c36d5212818"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="afsk_8c.html#a3930063ec9d82dd3e4ede9b51bfe05b8">afsk_dac_isr</a> (<a class="el" href="structAfsk.html">Afsk</a> *af)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">DAC ISR callback.  <a href="#a3930063ec9d82dd3e4ede9b51bfe05b8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="afsk_8c.html#adeb64b951e0db5f70d574a525ddbb1da">afsk_init</a> (<a class="el" href="structAfsk.html">Afsk</a> *af, int adc_ch, int dac_ch)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize an AFSK1200 modem.  <a href="#adeb64b951e0db5f70d574a525ddbb1da"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const uint8_t PROGMEM&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="afsk_8c.html#a0a5ce8349ee990dade3d573f868eb4f6">sin_table</a> []</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sine table for the first quarter of wave.  <a href="#a0a5ce8349ee990dade3d573f868eb4f6"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>AFSK1200 modem. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Francesco Sacchi &lt;<a href="mailto:batt@develer.com">batt@develer.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="afsk_8c_source.html">afsk.c</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6e7a76ef4090f84faef32c36d5212818"></a><!-- doxytag: member="afsk.c::afsk_adc_isr" ref="a6e7a76ef4090f84faef32c36d5212818" args="(Afsk *af, int8_t curr_sample)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void afsk_adc_isr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAfsk.html">Afsk</a> *&#160;</td>
          <td class="paramname"><em>af</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>curr_sample</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>ADC ISR callback. </p>
<p>This function has to be called by the ADC ISR when a sample of the configured channel is available. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">af</td><td><a class="el" href="structAfsk.html" title="AFSK1200 modem context.">Afsk</a> context to operate on. </td></tr>
    <tr><td class="paramname">curr_sample</td><td>current sample from the ADC. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="afsk_8c_source.html#l00210">210</a> of file <a class="el" href="afsk_8c_source.html">afsk.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3930063ec9d82dd3e4ede9b51bfe05b8"></a><!-- doxytag: member="afsk.c::afsk_dac_isr" ref="a3930063ec9d82dd3e4ede9b51bfe05b8" args="(Afsk *af)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t afsk_dac_isr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAfsk.html">Afsk</a> *&#160;</td>
          <td class="paramname"><em>af</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>DAC ISR callback. </p>
<p>This function has to be called by the DAC ISR when a sample of the configured channel has been converted out.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">af</td><td><a class="el" href="structAfsk.html" title="AFSK1200 modem context.">Afsk</a> context to operate on.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The next DAC output sample. </dd></dl>

<p>Definition at line <a class="el" href="afsk_8c_source.html#l00342">342</a> of file <a class="el" href="afsk_8c_source.html">afsk.c</a>.</p>

</div>
</div>
<a class="anchor" id="adeb64b951e0db5f70d574a525ddbb1da"></a><!-- doxytag: member="afsk.c::afsk_init" ref="adeb64b951e0db5f70d574a525ddbb1da" args="(Afsk *af, int adc_ch, int dac_ch)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void afsk_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAfsk.html">Afsk</a> *&#160;</td>
          <td class="paramname"><em>af</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>adc_ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dac_ch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize an AFSK1200 modem. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">af</td><td><a class="el" href="structAfsk.html" title="AFSK1200 modem context.">Afsk</a> context to operate on. </td></tr>
    <tr><td class="paramname">adc_ch</td><td>ADC channel used by the demodulator. </td></tr>
    <tr><td class="paramname">dac_ch</td><td>DAC channel used by the modulator. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="afsk_8c_source.html#l00537">537</a> of file <a class="el" href="afsk_8c_source.html">afsk.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7f23d9977de50b84502f6847da998058"></a><!-- doxytag: member="afsk.c::hdlc_parse" ref="a7f23d9977de50b84502f6847da998058" args="(Hdlc *hdlc, bool bit, FIFOBuffer *fifo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool hdlc_parse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structHdlc.html">Hdlc</a> *&#160;</td>
          <td class="paramname"><em>hdlc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FIFOBuffer *&#160;</td>
          <td class="paramname"><em>fifo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>High-Level Data Link Control parsing function. </p>
<p>Parse bitstream in order to find characters.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">hdlc</td><td>HDLC context. </td></tr>
    <tr><td class="paramname">bit</td><td>current bit to be parsed. </td></tr>
    <tr><td class="paramname">fifo</td><td>FIFO buffer used to push characters.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if all is ok, false if the fifo is full. </dd></dl>

<p>Definition at line <a class="el" href="afsk_8c_source.html#l00127">127</a> of file <a class="el" href="afsk_8c_source.html">afsk.c</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a0a5ce8349ee990dade3d573f868eb4f6"></a><!-- doxytag: member="afsk.c::sin_table" ref="a0a5ce8349ee990dade3d573f868eb4f6" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t PROGMEM <a class="el" href="afsk_8c.html#a0a5ce8349ee990dade3d573f868eb4f6">sin_table</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment">
{
    128, 129, 131, 132, 134, 135, 137, 138, 140, 142, 143, 145, 146, 148, 149, 151,
    152, 154, 155, 157, 158, 160, 162, 163, 165, 166, 167, 169, 170, 172, 173, 175,
    176, 178, 179, 181, 182, 183, 185, 186, 188, 189, 190, 192, 193, 194, 196, 197,
    198, 200, 201, 202, 203, 205, 206, 207, 208, 210, 211, 212, 213, 214, 215, 217,
    218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233,
    234, 234, 235, 236, 237, 238, 238, 239, 240, 241, 241, 242, 243, 243, 244, 245,
    245, 246, 246, 247, 248, 248, 249, 249, 250, 250, 250, 251, 251, 252, 252, 252,
    253, 253, 253, 253, 254, 254, 254, 254, 254, 255, 255, 255, 255, 255, 255, 255,
}
</pre></div>
<p>Sine table for the first quarter of wave. </p>
<p>The rest of the wave is computed from this first quarter. This table is used to generate the modulated data. </p>

<p>Definition at line <a class="el" href="afsk_8c_source.html#l00081">81</a> of file <a class="el" href="afsk_8c_source.html">afsk.c</a>.</p>

</div>
</div>
</div>


