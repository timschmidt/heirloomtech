

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_121029064a25b6c8df3db8e9bf5fc73a.html">kern</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">signal.h</div>  </div>
</div>
<div class="contents">
<a href="signal_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00048"></a>00048 <span class="preprocessor">#ifndef KERN_SIGNAL_H</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span><span class="preprocessor">#define KERN_SIGNAL_H</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;<a class="code" href="compiler_8h.html" title="Additional support macros for compiler independance.">cfg/compiler.h</a>&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;<a class="code" href="macros_8h.html">cfg/macros.h</a>&gt;</span>    <span class="comment">// BV()</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="preprocessor">#include &lt;<a class="code" href="cpu_2irq_8h.html" title="CPU-specific IRQ definitions.">cpu/irq.h</a>&gt;</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="preprocessor">#include &lt;<a class="code" href="proc_8h.html">kern/proc.h</a>&gt;</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#if CONFIG_KERN_SIGNALS</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 INLINE <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> __sig_checkSignal(<a class="code" href="structSignal.html" title="Signal structure.">Signal</a> *s, <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sigs)
<a name="l00061"></a>00061 {
<a name="l00062"></a>00062     <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> result;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     result = s-&gt;<a class="code" href="structSignal.html#a3201749b1ec9fac0ce70874e9f858e49" title="Received signals.">recv</a> &amp; sigs;
<a name="l00065"></a>00065     s-&gt;<a class="code" href="structSignal.html#a3201749b1ec9fac0ce70874e9f858e49" title="Received signals.">recv</a> &amp;= ~sigs;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067     <span class="keywordflow">return</span> result;
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00075"></a><a class="code" href="group__kern__signal.html#gaf64ee6ca27fe4fab885fa122a77c47ba">00075</a> INLINE <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> <a class="code" href="group__kern__signal.html#gaf64ee6ca27fe4fab885fa122a77c47ba" title="Check if any of the signals in sigs has occurred and clear them.">sig_checkSignal</a>(<a class="code" href="structSignal.html" title="Signal structure.">Signal</a> *s, <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sigs)
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077     cpu_flags_t flags;
<a name="l00078"></a>00078     <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> result;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     IRQ_SAVE_DISABLE(flags);
<a name="l00081"></a>00081     result = __sig_checkSignal(s, sigs);
<a name="l00082"></a>00082     IRQ_RESTORE(flags);
<a name="l00083"></a>00083 
<a name="l00084"></a>00084     <span class="keywordflow">return</span> result;
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00092"></a><a class="code" href="group__kern__signal.html#ga493434e7efb03991eb6c73152207dc35">00092</a> INLINE <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> <a class="code" href="group__kern__signal.html#ga493434e7efb03991eb6c73152207dc35" title="Check if any of the signals in sigs has occurred and clear them.">sig_check</a>(<a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sigs)
<a name="l00093"></a>00093 {
<a name="l00094"></a>00094     Process *proc = <a class="code" href="group__kern__proc.html#gaaf85f02d7fa77e547dd2a770f2707b5f" title="Return the context structure of the currently running process.">proc_current</a>();
<a name="l00095"></a>00095     <span class="keywordflow">return</span> <a class="code" href="group__kern__signal.html#gaf64ee6ca27fe4fab885fa122a77c47ba" title="Check if any of the signals in sigs has occurred and clear them.">sig_checkSignal</a>(&amp;proc-&gt;sig, sigs);
<a name="l00096"></a>00096 }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="keywordtype">void</span> sig_sendSignal(<a class="code" href="structSignal.html" title="Signal structure.">Signal</a> *s, Process *proc, <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sig);
<a name="l00099"></a>00099 
<a name="l00110"></a><a class="code" href="group__kern__signal.html#ga9532c2e6c4894d567f648530b9500e8c">00110</a> INLINE <span class="keywordtype">void</span> <a class="code" href="group__kern__signal.html#ga9532c2e6c4894d567f648530b9500e8c" title="Send the signals sigs to the process proc and immeditaly dispatch it for execution.">sig_send</a>(Process *proc, <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sig)
<a name="l00111"></a>00111 {
<a name="l00112"></a>00112     sig_sendSignal(&amp;proc-&gt;sig, proc, sig);
<a name="l00113"></a>00113 }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="keywordtype">void</span> sig_postSignal(<a class="code" href="structSignal.html" title="Signal structure.">Signal</a> *s, Process *proc, <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sig);
<a name="l00116"></a>00116 
<a name="l00123"></a><a class="code" href="group__kern__signal.html#ga5348234f4750db67796ad17d82bb30fc">00123</a> INLINE <span class="keywordtype">void</span> <a class="code" href="group__kern__signal.html#ga5348234f4750db67796ad17d82bb30fc" title="Send the signals sigs to the process proc.">sig_post</a>(Process *proc, <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sig)
<a name="l00124"></a>00124 {
<a name="l00125"></a>00125     sig_postSignal(&amp;proc-&gt;sig, proc, sig);
<a name="l00126"></a>00126 }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="comment">/*</span>
<a name="l00129"></a>00129 <span class="comment"> * XXX: this is provided for backword compatibility, consider to make this</span>
<a name="l00130"></a>00130 <span class="comment"> * deprecated for the future.</span>
<a name="l00131"></a>00131 <span class="comment"> */</span>
<a name="l00132"></a>00132 INLINE <span class="keywordtype">void</span> sig_signal(Process *proc, <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sig)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134     sig_postSignal(&amp;proc-&gt;sig, proc, sig);
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sig_waitSignal(<a class="code" href="structSignal.html" title="Signal structure.">Signal</a> *s, <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sigs);
<a name="l00138"></a>00138 
<a name="l00144"></a><a class="code" href="group__kern__signal.html#ga83accf7cc9eb33c748b2670b8f272060">00144</a> INLINE <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> <a class="code" href="group__kern__signal.html#ga83accf7cc9eb33c748b2670b8f272060" title="Sleep until any of the signals in sigs occurs.">sig_wait</a>(<a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sigs)
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146     Process *proc = <a class="code" href="group__kern__proc.html#gaaf85f02d7fa77e547dd2a770f2707b5f" title="Return the context structure of the currently running process.">proc_current</a>();
<a name="l00147"></a>00147     <span class="keywordflow">return</span> sig_waitSignal(&amp;proc-&gt;sig, sigs);
<a name="l00148"></a>00148 }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sig_waitTimeoutSignal(<a class="code" href="structSignal.html" title="Signal structure.">Signal</a> *s, <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sigs, <a class="code" href="compiler_8h.html#a9f2d272efa5f391ffc4b9ec4eb59fa88" title="Type for time expressed in ticks.">ticks_t</a> timeout,
<a name="l00151"></a>00151                 <a class="code" href="compiler_8h.html#a29da6a2c5167c69f4e05da8466f2b339" title="User defined callback type.">Hook</a> func, <a class="code" href="compiler_8h.html#afebdfc027148249641ae51fb8c7914fc" title="Bulk storage large enough for both pointers or integers.">iptr_t</a> data);
<a name="l00152"></a>00152 
<a name="l00159"></a><a class="code" href="group__kern__signal.html#ga8ba42e90c57b627117b608cc11fd08ba">00159</a> INLINE <a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> <a class="code" href="group__kern__signal.html#ga8ba42e90c57b627117b608cc11fd08ba" title="Sleep until any of the signals in sigs or timeout ticks elapse.">sig_waitTimeout</a>(<a class="code" href="compiler_8h.html#a8eab9d9d79ff58f19a5a51e821d95330" title="Type for signal masks.">sigmask_t</a> sigs, <a class="code" href="compiler_8h.html#a9f2d272efa5f391ffc4b9ec4eb59fa88" title="Type for time expressed in ticks.">ticks_t</a> timeout)
<a name="l00160"></a>00160 {
<a name="l00161"></a>00161     Process *proc = <a class="code" href="group__kern__proc.html#gaaf85f02d7fa77e547dd2a770f2707b5f" title="Return the context structure of the currently running process.">proc_current</a>();
<a name="l00162"></a>00162     <span class="keywordflow">return</span> sig_waitTimeoutSignal(&amp;proc-&gt;sig, sigs, timeout,
<a name="l00163"></a>00163             NULL, NULL);
<a name="l00164"></a>00164 }
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 <span class="preprocessor">#endif </span><span class="comment">/* CONFIG_KERN_SIGNALS */</span>
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="keywordtype">int</span> signal_testRun(<span class="keywordtype">void</span>);
<a name="l00169"></a>00169 <span class="keywordtype">int</span> signal_testSetup(<span class="keywordtype">void</span>);
<a name="l00170"></a>00170 <span class="keywordtype">int</span> signal_testTearDown(<span class="keywordtype">void</span>);
<a name="l00171"></a>00171 
<a name="l00176"></a><a class="code" href="group__kern__signal.html#ga75be8f1e5c431785f5ee2fcf1b1d6de3">00176</a> <span class="preprocessor">#define SIG_USER0    BV(0)  </span>
<a name="l00177"></a><a class="code" href="group__kern__signal.html#ga91b38c1eca94889a36aef164f59aed3e">00177</a> <span class="preprocessor">#define SIG_USER1    BV(1)  </span>
<a name="l00178"></a><a class="code" href="group__kern__signal.html#ga94d49081d01c6f8c612402aec3771447">00178</a> <span class="preprocessor">#define SIG_USER2    BV(2)  </span>
<a name="l00179"></a><a class="code" href="group__kern__signal.html#ga435ed737dcb1a7cedd6fb9c541fd8f73">00179</a> <span class="preprocessor">#define SIG_USER3    BV(3)  </span>
<a name="l00180"></a><a class="code" href="group__kern__signal.html#ga7601fe23b72cbb7eba5853e9f8a1ee98">00180</a> <span class="preprocessor">#define SIG_SINGLE   BV(4)  </span>
<a name="l00181"></a><a class="code" href="group__kern__signal.html#gae2764882bf94d69b7aa96c64ca0e1c92">00181</a> <span class="preprocessor">#define SIG_SYSTEM5  BV(5)  </span>
<a name="l00182"></a><a class="code" href="group__kern__signal.html#gad1550657a48bb6d1f782768f576960c2">00182</a> <span class="preprocessor">#define SIG_SYSTEM6  BV(6)  </span>
<a name="l00183"></a><a class="code" href="group__kern__signal.html#gab31ff7e030f48d74c87e4aa69f719855">00183</a> <span class="preprocessor">#define SIG_TIMEOUT  BV(7)  </span>
<a name="l00188"></a><a class="code" href="group__kern__signal.html#ga63552cbdd54b41522663a570fd0c0b97">00188</a> <span class="preprocessor">#define SIG_USER_MAX SIG_SINGLE</span>
<a name="l00189"></a>00189 <span class="preprocessor"></span><span class="comment">/*\}*/</span>
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">/* \} */</span> <span class="comment">//defgroup kern_signal</span>
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="preprocessor">#endif </span><span class="comment">/* KERN_SIGNAL_H */</span>
</pre></div></div>
</div>


