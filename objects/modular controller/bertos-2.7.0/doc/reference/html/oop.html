

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Object Oriented Programming </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>BeRTOS uses object oriented programming concepts for the base interfaces. If used in the right way, OOP elegantly solves a broad range of problems linked with the creation of common and reusable interfaces that allow you to save development time and precious memory space. Have a look at <a href="http://www.bertos.org/use/tutorial-front-page/drivers-kfile-interface/">KFile tutorial</a> on BeRTOS web site for a more complete introduction to object oriented programming.</p>
<h2>OOP in C</h2>
<p>Object oriented programming in C requires a context struct and a few interface functions that operate on that context. The base class is implemented with a struct with a few function pointers that point to the implementation specific for the context.</p>
<p>Inherited classes are created by defining a struct with the following members: </p>
<ul>
<li>a base class member </li>
<li>context specific members</li>
</ul>
<p>Then you can call interface functions by simply using the base class member as the context of the function. Note that base classes usually don't have an init function, because they are not meant to be used directly and it wouldn't make sense anyway, since they provide no functionality, only the interface. The usage pattern requires you to declare a context (eg. <a class="el" href="structFlash.html" title="EmbFlash KBlock context structure.">Flash</a>), initialize the context with a specific function call (eg. <a class="el" href="group__drv__emb__flash.html#ga4ac5b95e3a0356f065fe0bb5eb9e3d33" title="Init function for flash driver.">flash_init()</a>) then use the interface funtions to access the context.</p>
<p>To make an example, in BeRTOS the <a class="el" href="structSerial.html" title="Serial handle structure.">Serial</a> driver is a derived class of the <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> interface. The <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> interface defines a few interface functions, which can be used to extract data from the <a class="el" href="structSerial.html" title="Serial handle structure.">Serial</a> context. </p>
<div class="fragment"><pre class="fragment"><span class="comment">// declare the serial context</span>
<a class="code" href="structSerial.html" title="Serial handle structure.">Serial</a> ser;
<span class="comment">// read buffer</span>
uint8_t buf[20];

<span class="keywordtype">int</span> main()
{
   <span class="comment">// initialize the serial driver</span>
   <a class="code" href="ser_8c.html#a088372086f192b2a8cfc8b12f80a1fb7" title="Init serial driver for unit.">ser_init</a>(&amp;ser, SER_UART0);
   <a class="code" href="ser_8c.html#a11f9fc76f87264fb606d3a479454facb" title="Set the baudrate for the serial port.">ser_setbaudrate</a>(115200);
   <span class="comment">// now access using the interface functions</span>
   <span class="comment">// read...</span>
   <a class="code" href="group__io__kfile.html#ga56f9291708a17fd2aed611844c4f9286" title="Read size bytes from file fd into buf.">kfile_read</a>(&amp;ser.<a class="code" href="structSerial.html#aa44c022a49bfe13f3ece632288cdda74" title="Serial have a KFile struct implementation.">fd</a>, buf, 20);
   <span class="comment">// ...and write</span>
   <a class="code" href="group__io__kfile.html#gaa04c60fc2dec055903884ab7d4a09111" title="Formatted write.">kfile_printf</a>(&amp;ser.<a class="code" href="structSerial.html#aa44c022a49bfe13f3ece632288cdda74" title="Serial have a KFile struct implementation.">fd</a>, <span class="stringliteral">&quot;Writing to serial using KFile interface...\n&quot;</span>);
   <span class="comment">// close the driver</span>
   <a class="code" href="group__io__kfile.html#ga09a98e161ef99b15efdd4c2d2ca03428" title="Close file.">kfile_close</a>(&amp;ser.<a class="code" href="structSerial.html#aa44c022a49bfe13f3ece632288cdda74" title="Serial have a KFile struct implementation.">fd</a>);
}
</pre></div> </div></div>


