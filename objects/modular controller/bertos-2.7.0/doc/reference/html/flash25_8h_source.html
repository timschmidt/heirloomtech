

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_f7c89dbd63e8f34e572fe939945c15d7.html">drv</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">flash25.h</div>  </div>
</div>
<div class="contents">
<a href="flash25_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00044"></a>00044 <span class="preprocessor">#ifndef DRV_FLASH25_H</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span><span class="preprocessor">#define DRV_FLASH25_H</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="cfg__flash25_8h.html" title="Configuration file for flash25 module.">cfg/cfg_flash25.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="compiler_8h.html" title="Additional support macros for compiler independance.">cfg/compiler.h</a>&gt;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;<a class="code" href="io_2kfile_8h.html">io/kfile.h</a>&gt;</span>
<a name="l00051"></a>00051 
<a name="l00055"></a><a class="code" href="flash25_8h.html#a27a132cc531b762316bb8cfc681beb52">00055</a> <span class="keyword">typedef</span> uint32_t <a class="code" href="flash25_8h.html#a27a132cc531b762316bb8cfc681beb52" title="Type definition for serial flash memory.">flash25Addr_t</a>;
<a name="l00056"></a>00056 <span class="keyword">typedef</span> uint32_t flash25Size_t;
<a name="l00057"></a>00057 <span class="keyword">typedef</span> uint8_t flash25Offset_t;
<a name="l00058"></a>00058 
<a name="l00062"></a><a class="code" href="structFlash25.html">00062</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structFlash25.html" title="Flash25 KFile context structure.">Flash25</a>
<a name="l00063"></a>00063 {
<a name="l00064"></a><a class="code" href="structFlash25.html#a9e5b62edf0fabc6f84b5f03a30307553">00064</a>     <a class="code" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> <a class="code" href="structFlash25.html#a9e5b62edf0fabc6f84b5f03a30307553" title="File descriptor.">fd</a>;                       
<a name="l00065"></a><a class="code" href="structFlash25.html#a2c3274c56b4776e6f0192ee9bdf54716">00065</a>     <a class="code" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> *<a class="code" href="structFlash25.html#a2c3274c56b4776e6f0192ee9bdf54716" title="Dataflash comm channel (usually SPI).">channel</a>;                 
<a name="l00066"></a>00066 } <a class="code" href="structFlash25.html" title="Flash25 KFile context structure.">Flash25</a>;
<a name="l00067"></a>00067 
<a name="l00071"></a><a class="code" href="flash25_8h.html#a088548dbf8b22169a9a5c77581e092f8">00071</a> <span class="preprocessor">#define KFT_FLASH25 MAKE_ID(&#39;F&#39;, &#39;L&#39;, &#39;2&#39;, &#39;5&#39;)</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span>
<a name="l00073"></a>00073 
<a name="l00077"></a><a class="code" href="flash25_8h.html#aaddd8186f5084344b04cda86056d2687">00077</a> INLINE <a class="code" href="structFlash25.html" title="Flash25 KFile context structure.">Flash25</a> * <a class="code" href="flash25_8h.html#aaddd8186f5084344b04cda86056d2687" title="Convert + ASSERT from generic KFile to Flash25.">FLASH25_CAST</a>(<a class="code" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> *fd)
<a name="l00078"></a>00078 {
<a name="l00079"></a>00079     <a class="code" href="group__debug.html#gaca68c0d4ac8df0838e209fb5300f7be3" title="Assert a pre-condition on code.">ASSERT</a>(fd-&gt;_type == <a class="code" href="flash25_8h.html#a088548dbf8b22169a9a5c77581e092f8" title="ID for dataflash.">KFT_FLASH25</a>);
<a name="l00080"></a>00080     <span class="keywordflow">return</span> (<a class="code" href="structFlash25.html" title="Flash25 KFile context structure.">Flash25</a> *)fd;
<a name="l00081"></a>00081 }
<a name="l00082"></a>00082 
<a name="l00092"></a><a class="code" href="flash25_8h.html#a44e6d98de1057e2300692bbc10520b8a">00092</a> <span class="preprocessor">#define FLASH25_AT25F2048         1</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span>
<a name="l00094"></a>00094 <span class="preprocessor">#if CONFIG_FLASH25 == FLASH25_AT25F2048</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span><span class="preprocessor">    #define FLASH25_MANUFACTURER_ID    0x1F  // ATMEL</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span><span class="preprocessor">    #define FLASH25_DEVICE_ID          0x63  // Device ID</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span><span class="preprocessor">    #define FLASH25_PAGE_SIZE          256   // Page size in byte</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span><span class="preprocessor">    #define FLASH25_NUM_SECTOR         4     // Number of section in serial memory</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span><span class="preprocessor">    #define FLASH25_SECTOR_SIZE        65536UL // Section size in byte</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span><span class="preprocessor">    #define FLASH25_MEM_SIZE           FLASH25_NUM_SECTOR * FLASH25_SECTOR_SIZE</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span><span class="preprocessor">    #define FLASH25_NUM_PAGE           FLASH25_MEM_SIZE / FLASH25_PAGE_SIZE</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00103"></a>00103 <span class="preprocessor"></span><span class="preprocessor">    #error Nothing memory defined in CONFIG_FLASH25 are support.</span>
<a name="l00104"></a>00104 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span>
<a name="l00106"></a>00106 <span class="preprocessor">#define RDY_BIT     0x1 // Statuts of write cycle</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span>
<a name="l00111"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2">00111</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00112"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2aff0dd03fb78d6b1cbbf4bd3a54d15e9d">00112</a>     <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2aff0dd03fb78d6b1cbbf4bd3a54d15e9d" title="Set write enable latch.">FLASH25_WREN</a>            = 0x6,  
<a name="l00113"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a6d2090ee92f98e5a7be972c16b138f22">00113</a>     <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a6d2090ee92f98e5a7be972c16b138f22" title="Reset enable write latch.">FLASH25_WRDI</a>            = 0x4,  
<a name="l00114"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a5cf3dab648c1e2da8851a8fa89c30e8b">00114</a>     <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a5cf3dab648c1e2da8851a8fa89c30e8b" title="Read status register.">FLASH25_RDSR</a>            = 0x5,  
<a name="l00115"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a3732930727cc3047edf060a6b4b7fd1d">00115</a>     <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a3732930727cc3047edf060a6b4b7fd1d" title="Write status register.">FLASH25_WRSR</a>            = 0x1,  
<a name="l00116"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a9665e10df96f3cab0c7467627d76ded9">00116</a>     <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a9665e10df96f3cab0c7467627d76ded9" title="Read data from memory array.">FLASH25_READ</a>            = 0x3,  
<a name="l00117"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a1d76435cdcffdcb855e057495164f355">00117</a>     <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a1d76435cdcffdcb855e057495164f355" title="Program data into memory array.">FLASH25_PROGRAM</a>         = 0x2,  
<a name="l00118"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a855c467fc8a00b5ca2d91bca787406f0">00118</a>     <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a855c467fc8a00b5ca2d91bca787406f0" title="Erase one sector in memory array.">FLASH25_SECTORE_ERASE</a>   = 0x52, 
<a name="l00119"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a093fb44854491186a231c8eeb74654ac">00119</a>     <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2a093fb44854491186a231c8eeb74654ac" title="Erase all sector in memory array.">FLASH25_CHIP_ERASE</a>      = 0x62, 
<a name="l00120"></a><a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2aa2d67f2ac05f7746892e4291affc83e9">00120</a>     <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2aa2d67f2ac05f7746892e4291affc83e9" title="Read Manufacturer and product ID.">FLASH25_RDID</a>            = 0x15 
<a name="l00121"></a>00121 } <a class="code" href="flash25_8h.html#a1316fb8f73aab9304ffa5d5266b4d2f2" title="Serial flash opcode commands.">Flash25Opcode</a>;
<a name="l00122"></a>00122 
<a name="l00126"></a>00126 <span class="preprocessor">#if CONFIG_FLASH25 != FLASH25_AT25F2048</span>
<a name="l00127"></a>00127 <span class="preprocessor"></span><span class="preprocessor">    #error Nothing memory defined in CONFIG_FLASH25 are support.</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>
<a name="l00130"></a><a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149">00130</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00131"></a><a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149a321642cacf491facf5432b47241324ef">00131</a>     <a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149a321642cacf491facf5432b47241324ef" title="Sector 1 (0x0 -0xFFFF)">FLASH25_SECT1</a>            = 0x0,      
<a name="l00132"></a><a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149a22b653d4447a4cccb9fc0be56b2dbbbc">00132</a>     <a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149a22b653d4447a4cccb9fc0be56b2dbbbc" title="Sector 2 (0x10000 -0x1FFFF)">FLASH25_SECT2</a>            = 0x10000,  
<a name="l00133"></a><a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149af4252d0684baf6441c9044ea96812021">00133</a>     <a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149af4252d0684baf6441c9044ea96812021" title="Sector 3 (0x20000 -0x2FFFF)">FLASH25_SECT3</a>            = 0x20000,  
<a name="l00134"></a><a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149aa06d269ec5320cb34f2230591aada734">00134</a>     <a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149aa06d269ec5320cb34f2230591aada734" title="Sector 4 (0x30000 -0x3FFFF)">FLASH25_SECT4</a>            = 0x30000,  
<a name="l00135"></a>00135 } <a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149" title="Serial flash sector memory address.">Flash25Sector</a>;
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="keywordtype">void</span> <a class="code" href="flash25_8c.html#aec953d4584d90f7d9311eaf7a5498f76" title="Init data flash memory interface.">flash25_init</a>(<a class="code" href="structFlash25.html" title="Flash25 KFile context structure.">Flash25</a> *fd, <a class="code" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> *ch);
<a name="l00138"></a>00138 <span class="keywordtype">void</span> <a class="code" href="flash25_8c.html#aa4798197fae4a3eb7af814c2223d13e9" title="Chip erase function.">flash25_chipErase</a>(<a class="code" href="structFlash25.html" title="Flash25 KFile context structure.">Flash25</a> *fd);
<a name="l00139"></a>00139 <span class="keywordtype">void</span> <a class="code" href="flash25_8c.html#a8b90ef6909c4b8c536cef52a9a8506fa" title="Sector erase function.">flash25_sectorErase</a>(<a class="code" href="structFlash25.html" title="Flash25 KFile context structure.">Flash25</a> *fd, <a class="code" href="flash25_8h.html#a4a39dd8c8453af325a550678d19c4149" title="Serial flash sector memory address.">Flash25Sector</a> sector);
<a name="l00140"></a>00140 <span class="keywordtype">bool</span> <a class="code" href="flash25_8h.html#a7b42f9bbe3af09611f7d55dca4d32993" title="Test function for flash25.">flash25_test</a>(<a class="code" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> *channel);
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 <span class="preprocessor">#endif </span><span class="comment">/* DRV_FLASH25_H */</span>
<a name="l00143"></a>00143 
</pre></div></div>
</div>


