

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_f7c89dbd63e8f34e572fe939945c15d7.html">drv</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">dataflash.c File Reference</div>  </div>
</div>
<div class="contents">

<p>Function library for dataflash AT45DB family (implementation).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="dataflash_8h_source.html">dataflash.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cfg__dataflash_8h_source.html">cfg/cfg_dataflash.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="macros_8h_source.html">cfg/macros.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="debug_8h_source.html">cfg/debug.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="module_8h_source.html">cfg/module.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="log_8h_source.html">cfg/log.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="timer_8h_source.html">drv/timer.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="battfs_8h_source.html">fs/battfs.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="power_8h_source.html">cpu/power.h</a>&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
</div>
<p><a href="dataflash_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a6444242f2a9416ca7c4f9e1c669833de">CS_TOGGLE</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro that toggle CS of dataflash.  <a href="#a6444242f2a9416ca7c4f9e1c669833de"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#abc1fee4b96868dcfae96aca2b00df292">send_cmd</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd, <a class="el" href="dataflash_8h.html#a6736fa391e3a05f8b73c87291ff26640">dataflash_page_t</a> page_addr, <a class="el" href="dataflash_8h.html#a452e496b581ae3449b4f6a3886891424">dataflash_offset_t</a> byte_addr, <a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92">DataFlashOpcode</a> opcode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a generic command to dataflash memory.  <a href="#abc1fee4b96868dcfae96aca2b00df292"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a78e2fd4805196b9819cad98cd2d6bdf0">dataflash_reset</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset dataflash memory function.  <a href="#a78e2fd4805196b9819cad98cd2d6bdf0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a11de8abefc56ede6636adba2888027c8"></a><!-- doxytag: member="dataflash.c::dataflash_stat" ref="a11de8abefc56ede6636adba2888027c8" args="(DataFlash *fd)" -->
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a11de8abefc56ede6636adba2888027c8">dataflash_stat</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read status register of dataflah memory. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aebf1748c49c9853d6df166b0d4eb39bb"></a><!-- doxytag: member="dataflash.c::dataflash_cmd" ref="aebf1748c49c9853d6df166b0d4eb39bb" args="(DataFlash *fd, dataflash_page_t page_addr, dataflash_offset_t byte_addr, DataFlashOpcode opcode)" -->
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#aebf1748c49c9853d6df166b0d4eb39bb">dataflash_cmd</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd, <a class="el" href="dataflash_8h.html#a6736fa391e3a05f8b73c87291ff26640">dataflash_page_t</a> page_addr, <a class="el" href="dataflash_8h.html#a452e496b581ae3449b4f6a3886891424">dataflash_offset_t</a> byte_addr, <a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92">DataFlashOpcode</a> opcode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Send one command to data flash memory, and return status register value. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9434337bfe323b9e8fd206bfbc2c149e"></a><!-- doxytag: member="dataflash.c::dataflash_readBlock" ref="a9434337bfe323b9e8fd206bfbc2c149e" args="(DataFlash *fd, dataflash_page_t page_addr, dataflash_offset_t byte_addr, uint8_t *block, dataflash_size_t len)" -->
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a9434337bfe323b9e8fd206bfbc2c149e">dataflash_readBlock</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd, <a class="el" href="dataflash_8h.html#a6736fa391e3a05f8b73c87291ff26640">dataflash_page_t</a> page_addr, <a class="el" href="dataflash_8h.html#a452e496b581ae3449b4f6a3886891424">dataflash_offset_t</a> byte_addr, uint8_t *block, <a class="el" href="dataflash_8h.html#a9aa2cd64e8fd8bf19413f1dc61399006">dataflash_size_t</a> len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read <em>len</em> bytes from main data flash memory or buffer data flash memory, and put it in <em>*block</em>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a4a4708d8cb2a548fab20a4cd542d6783">dataflash_writeBlock</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd, <a class="el" href="dataflash_8h.html#a452e496b581ae3449b4f6a3886891424">dataflash_offset_t</a> offset, const uint8_t *block, <a class="el" href="dataflash_8h.html#a9aa2cd64e8fd8bf19413f1dc61399006">dataflash_size_t</a> len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write <em>len</em> bytes in dataflash memory buffer.  <a href="#a4a4708d8cb2a548fab20a4cd542d6783"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8b77fe7f277c386917fd1eb60c38b432"></a><!-- doxytag: member="dataflash.c::dataflash_loadPage" ref="a8b77fe7f277c386917fd1eb60c38b432" args="(DataFlash *fd, dataflash_page_t page_addr)" -->
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a8b77fe7f277c386917fd1eb60c38b432">dataflash_loadPage</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd, <a class="el" href="dataflash_8h.html#a6736fa391e3a05f8b73c87291ff26640">dataflash_page_t</a> page_addr)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Load selected page from dataflash memory to buffer. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a49f0924277957cb11e076253d79d37d0"></a><!-- doxytag: member="dataflash.c::dataflash_flush" ref="a49f0924277957cb11e076253d79d37d0" args="(KFile *_fd)" -->
static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a49f0924277957cb11e076253d79d37d0">dataflash_flush</a> (<a class="el" href="structKFile.html">KFile</a> *_fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush select page (stored in buffer) in data flash main memory page. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2958c521a1989296baed7ee8721eb961"></a><!-- doxytag: member="dataflash.c::dataflash_close" ref="a2958c521a1989296baed7ee8721eb961" args="(struct KFile *_fd)" -->
static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a2958c521a1989296baed7ee8721eb961">dataflash_close</a> (struct <a class="el" href="structKFile.html">KFile</a> *_fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Close file <em>fd</em>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad212af6ae8580f53111408d8a5fe8671"></a><!-- doxytag: member="dataflash.c::dataflash_reopen" ref="ad212af6ae8580f53111408d8a5fe8671" args="(KFile *_fd)" -->
static <a class="el" href="structKFile.html">KFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#ad212af6ae8580f53111408d8a5fe8671">dataflash_reopen</a> (<a class="el" href="structKFile.html">KFile</a> *_fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reopen dataflash file <em>fd</em>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#aed9601bbf4f0e3593459fb5d187f6319">dataflash_read</a> (struct <a class="el" href="structKFile.html">KFile</a> *_fd, void *buf, size_t size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read in <em>buf</em> <em>size</em> bytes from dataflash memmory.  <a href="#aed9601bbf4f0e3593459fb5d187f6319"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a4765b1337cb8eb95b1db5f2bcf973c39">dataflash_write</a> (struct <a class="el" href="structKFile.html">KFile</a> *_fd, const void *_buf, size_t size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write <em>_buf</em> in dataflash memory.  <a href="#a4765b1337cb8eb95b1db5f2bcf973c39"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a524d11c33d73a33947a089d9bfe6bfc7">dataflash_init</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd, <a class="el" href="structKFile.html">KFile</a> *ch, <a class="el" href="dataflash_8h.html#a734aa6956f6ea34cd612b934e3003675">DataflashType</a> dev, dataflash_setCS_t *setCS, dataflash_setReset_t *setReset)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Dataflash init function.  <a href="#a524d11c33d73a33947a089d9bfe6bfc7"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a842bf71317598713858dd284d2d620a0"></a><!-- doxytag: member="dataflash.c::mem_info" ref="a842bf71317598713858dd284d2d620a0" args="[]" -->
static const <a class="el" href="structDataflashInfo.html">DataflashInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8c.html#a842bf71317598713858dd284d2d620a0">mem_info</a> []</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Array used to describe dataflash memory devices currently supported. <br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Function library for dataflash AT45DB family (implementation). </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Daniele Basile &lt;<a href="mailto:asterix@develer.com">asterix@develer.com</a>&gt; </dd>
<dd>
Francesco Sacchi &lt;<a href="mailto:batt@develer.com">batt@develer.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="dataflash_8c_source.html">dataflash.c</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6444242f2a9416ca7c4f9e1c669833de"></a><!-- doxytag: member="dataflash.c::CS_TOGGLE" ref="a6444242f2a9416ca7c4f9e1c669833de" args="(DataFlash *fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CS_TOGGLE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDataFlash.html">DataFlash</a> *&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Macro that toggle CS of dataflash. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>This is equivalent to fd-&gt;setCS(false) immediately followed by fd-&gt;setCS(true). </dd></dl>

<p>Definition at line <a class="el" href="dataflash_8c_source.html#l00106">106</a> of file <a class="el" href="dataflash_8c_source.html">dataflash.c</a>.</p>

</div>
</div>
<a class="anchor" id="a524d11c33d73a33947a089d9bfe6bfc7"></a><!-- doxytag: member="dataflash.c::dataflash_init" ref="a524d11c33d73a33947a089d9bfe6bfc7" args="(DataFlash *fd, KFile *ch, DataflashType dev, dataflash_setCS_t *setCS, dataflash_setReset_t *setReset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dataflash_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDataFlash.html">DataFlash</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dataflash_8h.html#a734aa6956f6ea34cd612b934e3003675">DataflashType</a>&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dataflash_setCS_t *&#160;</td>
          <td class="paramname"><em>setCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dataflash_setReset_t *&#160;</td>
          <td class="paramname"><em>setReset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dataflash init function. </p>
<p>This function initialize <em>fd</em> with SPI channel <em>ch</em> and test if data flash memory density is the same specified by device <em>dev</em>. <em>setCS</em> is a callback used to set/reset CS line. <em>setReset</em> is a callback used to set/reset the dataflash (can be NULL if reset is unconnected) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if ok, false if memory density read from dataflash is not compliant with the configured one. </dd></dl>

<p>Definition at line <a class="el" href="dataflash_8c_source.html#l00545">545</a> of file <a class="el" href="dataflash_8c_source.html">dataflash.c</a>.</p>

</div>
</div>
<a class="anchor" id="aed9601bbf4f0e3593459fb5d187f6319"></a><!-- doxytag: member="dataflash.c::dataflash_read" ref="aed9601bbf4f0e3593459fb5d187f6319" args="(struct KFile *_fd, void *buf, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static size_t dataflash_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>_fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read in <em>buf</em> <em>size</em> bytes from dataflash memmory. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>For reading data flash memory, we check flag page_dirty, if is true (that mean we have written a byte in buffer memory) we flush current page in main memory and then read from memory, else we read byte directly from data flash main memory.</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bytes read. </dd></dl>

<p>Definition at line <a class="el" href="dataflash_8c_source.html#l00429">429</a> of file <a class="el" href="dataflash_8c_source.html">dataflash.c</a>.</p>

</div>
</div>
<a class="anchor" id="a78e2fd4805196b9819cad98cd2d6bdf0"></a><!-- doxytag: member="dataflash.c::dataflash_reset" ref="a78e2fd4805196b9819cad98cd2d6bdf0" args="(DataFlash *fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dataflash_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDataFlash.html">DataFlash</a> *&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reset dataflash memory function. </p>
<p>If <em>fd-&gt;setReset</em> function is not NULL, this function resets data flash memory with one pulse reset long about 10usec. </p>

<p>Definition at line <a class="el" href="dataflash_8c_source.html#l00166">166</a> of file <a class="el" href="dataflash_8c_source.html">dataflash.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4765b1337cb8eb95b1db5f2bcf973c39"></a><!-- doxytag: member="dataflash.c::dataflash_write" ref="a4765b1337cb8eb95b1db5f2bcf973c39" args="(struct KFile *_fd, const void *_buf, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static size_t dataflash_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>_fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write <em>_buf</em> in dataflash memory. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>For writing <em>_buf</em> in dataflash memory, we must first write in buffer data flash memory. At the end of write, we can put page in dataflash main memory. If we write in two contiguous pages, we put in main memory current page and then reload the page which we want to write.</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bytes write. </dd></dl>

<p>Definition at line <a class="el" href="dataflash_8c_source.html#l00479">479</a> of file <a class="el" href="dataflash_8c_source.html">dataflash.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4a4708d8cb2a548fab20a4cd542d6783"></a><!-- doxytag: member="dataflash.c::dataflash_writeBlock" ref="a4a4708d8cb2a548fab20a4cd542d6783" args="(DataFlash *fd, dataflash_offset_t offset, const uint8_t *block, dataflash_size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dataflash_writeBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDataFlash.html">DataFlash</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dataflash_8h.html#a452e496b581ae3449b4f6a3886891424">dataflash_offset_t</a>&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dataflash_8h.html#a9aa2cd64e8fd8bf19413f1dc61399006">dataflash_size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write <em>len</em> bytes in dataflash memory buffer. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Is not possible to write directly in dataflash main memory. To perform a write in main memory you must first write in dataflash buffer memory and then send a command to write the page in main memory. </dd></dl>

<p>Definition at line <a class="el" href="dataflash_8c_source.html#l00258">258</a> of file <a class="el" href="dataflash_8c_source.html">dataflash.c</a>.</p>

</div>
</div>
<a class="anchor" id="abc1fee4b96868dcfae96aca2b00df292"></a><!-- doxytag: member="dataflash.c::send_cmd" ref="abc1fee4b96868dcfae96aca2b00df292" args="(DataFlash *fd, dataflash_page_t page_addr, dataflash_offset_t byte_addr, DataFlashOpcode opcode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void send_cmd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDataFlash.html">DataFlash</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dataflash_8h.html#a6736fa391e3a05f8b73c87291ff26640">dataflash_page_t</a>&#160;</td>
          <td class="paramname"><em>page_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dataflash_8h.html#a452e496b581ae3449b4f6a3886891424">dataflash_offset_t</a>&#160;</td>
          <td class="paramname"><em>byte_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92">DataFlashOpcode</a>&#160;</td>
          <td class="paramname"><em>opcode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send a generic command to dataflash memory. </p>
<p>This function send only 4 byte: opcode, page address and byte address. </p>

<p>Definition at line <a class="el" href="dataflash_8c_source.html#l00117">117</a> of file <a class="el" href="dataflash_8c_source.html">dataflash.c</a>.</p>

</div>
</div>
</div>


