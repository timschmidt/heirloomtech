

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">KFile interface</div>  </div>
<div class="ingroups"><a class="el" href="group__core.html">BeRTOS core functionality</a></div></div>
<div class="contents">

<p>Virtual <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> I/O interface.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structKFile.html">ReOpenFunc_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Context data for callback functions which operate on pseudo files.  <a href="structKFile.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga5137f80da20dbbbb731a84c9671612cd"></a><!-- doxytag: member="io_kfile::kfile_off_t" ref="ga5137f80da20dbbbb731a84c9671612cd" args="" -->
typedef int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> offset type, used by <a class="el" href="group__io__kfile.html#ga9cd820012ea1521e8f5a0eacfafae35d" title="Seek into file (if seekable).">kfile_seek()</a>. <br/></td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga8f7714669a9397929a467e1d0d458e00">KSeekMode</a> { <a class="el" href="group__io__kfile.html#gga8f7714669a9397929a467e1d0d458e00aad38c62dd35ece8c8aa9c609f4f59b2e">KSM_SEEK_SET</a>, 
<a class="el" href="group__io__kfile.html#gga8f7714669a9397929a467e1d0d458e00a3740314166f470d8abef3b9cbe8c3ce7">KSM_SEEK_CUR</a>, 
<a class="el" href="group__io__kfile.html#gga8f7714669a9397929a467e1d0d458e00aa091a159fb371f5e63f0fa8087904e1a">KSM_SEEK_END</a>
 }</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Costants for repositioning read/write file offset.  <a href="group__io__kfile.html#ga8f7714669a9397929a467e1d0d458e00">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#gacac5698d355a3750f4b07415090ed7a4">kfile_genericSeek</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd, <a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a> offset, <a class="el" href="group__io__kfile.html#ga8f7714669a9397929a467e1d0d458e00">KSeekMode</a> whence)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Move <em>fd</em> file seek position of <em>offset</em> bytes from <em>whence</em>.  <a href="#gacac5698d355a3750f4b07415090ed7a4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga1f1f5efe44ff91c5bea49f88f356059a">kfile_genericReopen</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reopen file <em>fd</em>.  <a href="#ga1f1f5efe44ff91c5bea49f88f356059a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga32306b8d90302fa70007aff8c1189bc5">kfile_genericClose</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Close file <em>fd</em>.  <a href="#ga32306b8d90302fa70007aff8c1189bc5"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
KFile access functions</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrpe41c4ab21d85477519e889dfaaeaa709"></a>Interface functions for <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> access. </p>
</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga56f9291708a17fd2aed611844c4f9286">kfile_read</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd, void *buf, size_t size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read <em>size</em> bytes from file <em>fd</em> into <em>buf</em>.  <a href="#ga56f9291708a17fd2aed611844c4f9286"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#gaf33cb00f56adefabb98d534d526525eb">kfile_gets</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd, char *buf, int size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a line long at most as size and put it in buf.  <a href="#gaf33cb00f56adefabb98d534d526525eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga146ed5c09d27f419f4c44344d8845330">kfile_gets_echo</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd, char *buf, int size, bool echo)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a line long at most as size and put it in buf, with optional echo.  <a href="#ga146ed5c09d27f419f4c44344d8845330"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga4709ef6ca6bf298bc52c87840dc22691">kfile_copy</a> (<a class="el" href="structKFile.html">KFile</a> *src, <a class="el" href="structKFile.html">KFile</a> *dst, <a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a> size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy <em>size</em> bytes from file <em>src</em> to <em>dst</em>.  <a href="#ga4709ef6ca6bf298bc52c87840dc22691"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga49de172ff5e373bcd3cba80b5158a79f">kfile_write</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd, const void *buf, size_t size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write <em>size</em> bytes from buffer <em>buf</em> into <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> <em>fd</em>.  <a href="#ga49de172ff5e373bcd3cba80b5158a79f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa04c60fc2dec055903884ab7d4a09111"></a><!-- doxytag: member="io_kfile::kfile_printf" ref="gaa04c60fc2dec055903884ab7d4a09111" args="(struct KFile *fd, const char *format,...)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#gaa04c60fc2dec055903884ab7d4a09111">kfile_printf</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd, const char *format,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Formatted write. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#gaaba6667da830aba35851b4c70d8783dd">kfile_print</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd, const char *s)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a string to kfile <em>fd</em>.  <a href="#gaaba6667da830aba35851b4c70d8783dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga9cd820012ea1521e8f5a0eacfafae35d">kfile_seek</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd, <a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a> offset, <a class="el" href="group__io__kfile.html#ga8f7714669a9397929a467e1d0d458e00">KSeekMode</a> whence)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Seek into file (if seekable).  <a href="#ga9cd820012ea1521e8f5a0eacfafae35d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structKFile.html">KFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga008259f87414718177676b6d93c1908d">kfile_reopen</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Close and reopen file <em>fd</em>.  <a href="#ga008259f87414718177676b6d93c1908d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga09a98e161ef99b15efdd4c2d2ca03428">kfile_close</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Close file.  <a href="#ga09a98e161ef99b15efdd4c2d2ca03428"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga6165c7b653acc06b5c9a6334540ac8fc">kfile_flush</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush file I/O.  <a href="#ga6165c7b653acc06b5c9a6334540ac8fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga9638c7d7f76976a58ceb670c28e13c39">kfile_error</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get file error mask.  <a href="#ga9638c7d7f76976a58ceb670c28e13c39"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga40a4b4a6c5b44f6377e51e7484650324"></a><!-- doxytag: member="io_kfile::kfile_clearerr" ref="ga40a4b4a6c5b44f6377e51e7484650324" args="(struct KFile *fd)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga40a4b4a6c5b44f6377e51e7484650324">kfile_clearerr</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear errors. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga480c14426dc77cdfd786c3b5b9a9adf2"></a><!-- doxytag: member="io_kfile::kfile_putc" ref="ga480c14426dc77cdfd786c3b5b9a9adf2" args="(int c, struct KFile *fd)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga480c14426dc77cdfd786c3b5b9a9adf2">kfile_putc</a> (int c, struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic putc implementation using kfile_write. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga09cca6f02dc337ddff2b36b66a3fdd1c"></a><!-- doxytag: member="io_kfile::kfile_getc" ref="ga09cca6f02dc337ddff2b36b66a3fdd1c" args="(struct KFile *fd)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga09cca6f02dc337ddff2b36b66a3fdd1c">kfile_getc</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic getc implementation using kfile_read. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#ga13a065f1b039f4ce62d1fbb0da8c9c2d">kfile_resync</a> (<a class="el" href="structKFile.html">KFile</a> *fd, <a class="el" href="compiler_8h.html#ac6f57181b1edf6b9b510c8a1a66201c1">mtime_t</a> delay)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Discard input to resynchronize with remote end.  <a href="#ga13a065f1b039f4ce62d1fbb0da8c9c2d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gada2185b090d77fbb33ab01da3f22a8a9"></a><!-- doxytag: member="io_kfile::kfile_init" ref="gada2185b090d77fbb33ab01da3f22a8a9" args="(struct KFile *fd)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__io__kfile.html#gada2185b090d77fbb33ab01da3f22a8a9">kfile_init</a> (struct <a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Base class <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> constructor. <br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>Virtual <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> I/O interface. </p>
<p><a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> is a simple, generic interface for file I/O. It uses an object-oriented model to supply a device-neutral interface to communicate with drivers.</p>
<p>This module contains only definitions, the instance structure and the common API. Each <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> subclass can override one or more methods of the interface, and can extend the base <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> structure with its own private data. For instance, a serial driver might implement the <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> interface by declaring a context structure like this:</p>
<div class="fragment"><pre class="fragment"> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structSerial.html" title="Serial handle structure.">Serial</a>
 {
      <span class="comment">// base class instance</span>
      <a class="code" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> <a class="code" href="structSerial.html#aa44c022a49bfe13f3ece632288cdda74" title="Serial have a KFile struct implementation.">fd</a>;

      <span class="comment">// private instance data</span>
      FIFOBuffer txfifo, rxfifo;
 } <a class="code" href="structSerial.html" title="Serial handle structure.">Serial</a>;
</pre></div><p>You should also supply a macro for casting <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> to <a class="el" href="structSerial.html" title="Serial handle structure.">Serial</a>:</p>
<div class="fragment"><pre class="fragment"> INLINE <a class="code" href="structSerial.html" title="Serial handle structure.">Serial</a> * SERIAL_CAST(<a class="code" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> *fd)
 {
        <a class="code" href="group__debug.html#gaca68c0d4ac8df0838e209fb5300f7be3" title="Assert a pre-condition on code.">ASSERT</a>(fd-&gt;_type == <a class="code" href="ser_8h.html#acdfc431807743dd3bafe120d69a8ae11" title="ID for serial.">KFT_SERIAL</a>);
        <span class="keywordflow">return</span> (<a class="code" href="structSerial.html" title="Serial handle structure.">Serial</a> *)fd;
 }
</pre></div><p>Then you can implement as many interface functions as needed and leave the rest to NULL.</p>
<p>Example implementation of the close <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> method for <a class="el" href="structSerial.html" title="Serial handle structure.">Serial</a>:</p>
<div class="fragment"><pre class="fragment"> <span class="keyword">static</span> <span class="keywordtype">int</span> ser_kfile_close(<span class="keyword">struct</span> <a class="code" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> *fd)
 {
        <a class="code" href="structSerial.html" title="Serial handle structure.">Serial</a> *fds = SERIAL_CAST(fd);
      <span class="comment">// [driver specific code here]</span>
        <span class="keywordflow">return</span> 0;
 }
</pre></div><p>The SERIAL_CAST() macro helps ensure that the passed object is really of type <a class="el" href="structSerial.html" title="Serial handle structure.">Serial</a>.</p>
<p>The <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> interface does not supply an open function: this is deliberate, because in embedded systems each device has its own init parameters. For the same reason, specific device settings like, for example, the baudrate, are not part of interface and should be handled by the driver-specific API.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Bernie Innocenti &lt;<a href="mailto:bernie@codewiz.org">bernie@codewiz.org</a>&gt; </dd>
<dd>
Francesco Sacchi &lt;<a href="mailto:batt@develer.com">batt@develer.com</a>&gt; </dd>
<dd>
Daniele Basile &lt;<a href="mailto:asterix@develer.com">asterix@develer.com</a>&gt; </dd></dl>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ga8f7714669a9397929a467e1d0d458e00"></a><!-- doxytag: member="io/kfile.h::KSeekMode" ref="ga8f7714669a9397929a467e1d0d458e00" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__io__kfile.html#ga8f7714669a9397929a467e1d0d458e00">KSeekMode</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Costants for repositioning read/write file offset. </p>
<p>These are needed because on some embedded platforms ANSI I/O library may not be present. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga8f7714669a9397929a467e1d0d458e00aad38c62dd35ece8c8aa9c609f4f59b2e"></a><!-- doxytag: member="KSM_SEEK_SET" ref="gga8f7714669a9397929a467e1d0d458e00aad38c62dd35ece8c8aa9c609f4f59b2e" args="" -->KSM_SEEK_SET</em>&nbsp;</td><td>
<p>Seek from file beginning. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga8f7714669a9397929a467e1d0d458e00a3740314166f470d8abef3b9cbe8c3ce7"></a><!-- doxytag: member="KSM_SEEK_CUR" ref="gga8f7714669a9397929a467e1d0d458e00a3740314166f470d8abef3b9cbe8c3ce7" args="" -->KSM_SEEK_CUR</em>&nbsp;</td><td>
<p>Seek from file current position. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga8f7714669a9397929a467e1d0d458e00aa091a159fb371f5e63f0fa8087904e1a"></a><!-- doxytag: member="KSM_SEEK_END" ref="gga8f7714669a9397929a467e1d0d458e00aa091a159fb371f5e63f0fa8087904e1a" args="" -->KSM_SEEK_END</em>&nbsp;</td><td>
<p>Seek from file end. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="io_2kfile_8h_source.html#l00121">121</a> of file <a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga09a98e161ef99b15efdd4c2d2ca03428"></a><!-- doxytag: member="io/kfile.h::kfile_close" ref="ga09a98e161ef99b15efdd4c2d2ca03428" args="(struct KFile *fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kfile_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close file. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EOF on errors. </dd></dl>

<p>Definition at line <a class="el" href="io_2kfile_8h_source.html#l00307">307</a> of file <a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga4709ef6ca6bf298bc52c87840dc22691"></a><!-- doxytag: member="io/kfile.h::kfile_copy" ref="ga4709ef6ca6bf298bc52c87840dc22691" args="(KFile *src, KFile *dst, kfile_off_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a> kfile_copy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy <em>size</em> bytes from file <em>src</em> to <em>dst</em>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Source <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a>. </td></tr>
    <tr><td class="paramname">dst</td><td>Destionation <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a>. </td></tr>
    <tr><td class="paramname">size</td><td>number of bytes to copy. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of bytes copied. </dd></dl>

<p>Definition at line <a class="el" href="kfile_8c_source.html#l00170">170</a> of file <a class="el" href="kfile_8c_source.html">kfile.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga9638c7d7f76976a58ceb670c28e13c39"></a><!-- doxytag: member="io/kfile.h::kfile_error" ref="ga9638c7d7f76976a58ceb670c28e13c39" args="(struct KFile *fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kfile_error </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get file error mask. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success or file error code, device specific. </dd></dl>

<p>Definition at line <a class="el" href="io_2kfile_8h_source.html#l00327">327</a> of file <a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga6165c7b653acc06b5c9a6334540ac8fc"></a><!-- doxytag: member="io/kfile.h::kfile_flush" ref="ga6165c7b653acc06b5c9a6334540ac8fc" args="(struct KFile *fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kfile_flush </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flush file I/O. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, EOF on errors. </dd></dl>

<p>Definition at line <a class="el" href="io_2kfile_8h_source.html#l00317">317</a> of file <a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga32306b8d90302fa70007aff8c1189bc5"></a><!-- doxytag: member="io/kfile.h::kfile_genericClose" ref="ga32306b8d90302fa70007aff8c1189bc5" args="(struct KFile *fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kfile_genericClose </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close file <em>fd</em>. </p>
<p>This is a generic implementation that only flush the file. </p>

<p>Definition at line <a class="el" href="kfile_8c_source.html#l00246">246</a> of file <a class="el" href="kfile_8c_source.html">kfile.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga1f1f5efe44ff91c5bea49f88f356059a"></a><!-- doxytag: member="io/kfile.h::kfile_genericReopen" ref="ga1f1f5efe44ff91c5bea49f88f356059a" args="(struct KFile *fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structKFile.html">KFile</a>* kfile_genericReopen </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reopen file <em>fd</em>. </p>
<p>This is a generic implementation that only flush file and reset seek_pos to 0. </p>

<p>Definition at line <a class="el" href="kfile_8c_source.html#l00235">235</a> of file <a class="el" href="kfile_8c_source.html">kfile.c</a>.</p>

</div>
</div>
<a class="anchor" id="gacac5698d355a3750f4b07415090ed7a4"></a><!-- doxytag: member="io/kfile.h::kfile_genericSeek" ref="gacac5698d355a3750f4b07415090ed7a4" args="(struct KFile *fd, kfile_off_t offset, KSeekMode whence)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a> kfile_genericSeek </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a>&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__io__kfile.html#ga8f7714669a9397929a467e1d0d458e00">KSeekMode</a>&#160;</td>
          <td class="paramname"><em>whence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Move <em>fd</em> file seek position of <em>offset</em> bytes from <em>whence</em>. </p>
<p>This is a generic implementation of seek function, you can redefine it in your local module if needed. </p>

<p>Definition at line <a class="el" href="kfile_8c_source.html#l00199">199</a> of file <a class="el" href="kfile_8c_source.html">kfile.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaf33cb00f56adefabb98d534d526525eb"></a><!-- doxytag: member="io/kfile.h::kfile_gets" ref="gaf33cb00f56adefabb98d534d526525eb" args="(struct KFile *fd, char *buf, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kfile_gets </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read a line long at most as size and put it in buf. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of chars read or EOF in case of error. </dd></dl>

<p>Definition at line <a class="el" href="kfile_8c_source.html#l00126">126</a> of file <a class="el" href="kfile_8c_source.html">kfile.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga146ed5c09d27f419f4c44344d8845330"></a><!-- doxytag: member="io/kfile.h::kfile_gets_echo" ref="ga146ed5c09d27f419f4c44344d8845330" args="(struct KFile *fd, char *buf, int size, bool echo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kfile_gets_echo </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>echo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read a line long at most as size and put it in buf, with optional echo. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of chars read, or EOF in case of error. </dd></dl>

<p>Definition at line <a class="el" href="kfile_8c_source.html#l00139">139</a> of file <a class="el" href="kfile_8c_source.html">kfile.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaaba6667da830aba35851b4c70d8783dd"></a><!-- doxytag: member="io/kfile.h::kfile_print" ref="gaaba6667da830aba35851b4c70d8783dd" args="(struct KFile *fd, const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kfile_print </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a string to kfile <em>fd</em>. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if OK, EOF in case of error. </dd></dl>

<p>Definition at line <a class="el" href="kfile_8c_source.html#l00109">109</a> of file <a class="el" href="kfile_8c_source.html">kfile.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga56f9291708a17fd2aed611844c4f9286"></a><!-- doxytag: member="io/kfile.h::kfile_read" ref="ga56f9291708a17fd2aed611844c4f9286" args="(struct KFile *fd, void *buf, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t kfile_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read <em>size</em> bytes from file <em>fd</em> into <em>buf</em>. </p>
<p>This function reads at most the number of requested bytes into the provided buffer. The value returned may be less than the requested bytes in case EOF is reached OR an error occurred. You need to check the error conditions using <a class="el" href="group__io__kfile.html#ga9638c7d7f76976a58ceb670c28e13c39" title="Get file error mask.">kfile_error()</a> to understand which case happened.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This function will block if there are less than <em>size</em> bytes to read.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td><a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> context. </td></tr>
    <tr><td class="paramname">buf</td><td>User provided buffer. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes to read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Number of bytes read. </dd></dl>

<p>Definition at line <a class="el" href="io_2kfile_8h_source.html#l00240">240</a> of file <a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga008259f87414718177676b6d93c1908d"></a><!-- doxytag: member="io/kfile.h::kfile_reopen" ref="ga008259f87414718177676b6d93c1908d" args="(struct KFile *fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structKFile.html">KFile</a>* kfile_reopen </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close and reopen file <em>fd</em>. </p>
<p>The reopening is done with the former file parameters and access modes. </p>

<p>Definition at line <a class="el" href="io_2kfile_8h_source.html#l00297">297</a> of file <a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga13a065f1b039f4ce62d1fbb0da8c9c2d"></a><!-- doxytag: member="io/kfile.h::kfile_resync" ref="ga13a065f1b039f4ce62d1fbb0da8c9c2d" args="(KFile *fd, mtime_t delay)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kfile_resync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="compiler_8h.html#ac6f57181b1edf6b9b510c8a1a66201c1">mtime_t</a>&#160;</td>
          <td class="paramname"><em>delay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Discard input to resynchronize with remote end. </p>
<p>Discard incoming data until the kfile_getc stops receiving characters for at least <em>delay</em> milliseconds.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>If the timeout occur, we reset the error before to quit. </dd></dl>

<p>Definition at line <a class="el" href="kfile_8c_source.html#l00261">261</a> of file <a class="el" href="kfile_8c_source.html">kfile.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga9cd820012ea1521e8f5a0eacfafae35d"></a><!-- doxytag: member="io/kfile.h::kfile_seek" ref="ga9cd820012ea1521e8f5a0eacfafae35d" args="(struct KFile *fd, kfile_off_t offset, KSeekMode whence)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a> kfile_seek </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__io__kfile.html#ga5137f80da20dbbbb731a84c9671612cd">kfile_off_t</a>&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__io__kfile.html#ga8f7714669a9397929a467e1d0d458e00">KSeekMode</a>&#160;</td>
          <td class="paramname"><em>whence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Seek into file (if seekable). </p>
<p>Move <em>fd</em> file seek position of <em>offset</em> bytes from <em>whence</em>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td><a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> context. </td></tr>
    <tr><td class="paramname">offset</td><td>Offset bytes to move from position <em>whence</em>. </td></tr>
    <tr><td class="paramname">whence</td><td>Position where to start the seek. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Current postion in the file. </dd></dl>

<p>Definition at line <a class="el" href="io_2kfile_8h_source.html#l00287">287</a> of file <a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga49de172ff5e373bcd3cba80b5158a79f"></a><!-- doxytag: member="io/kfile.h::kfile_write" ref="ga49de172ff5e373bcd3cba80b5158a79f" args="(struct KFile *fd, const void *buf, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t kfile_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write <em>size</em> bytes from buffer <em>buf</em> into <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> <em>fd</em>. </p>
<p>Return value may be less than <em>size</em>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td><a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> context. </td></tr>
    <tr><td class="paramname">buf</td><td>User provided data. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes to write. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Number of bytes written. </dd></dl>

<p>Definition at line <a class="el" href="io_2kfile_8h_source.html#l00268">268</a> of file <a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>.</p>

</div>
</div>
</div>


