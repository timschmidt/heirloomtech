

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_a5de7543e32a5f073daa04f8834eb5fd.html">cpu</a>      </li>
      <li class="navelem"><a class="el" href="dir_b85b1b77342b0233aa6bdb4655adc5e9.html">cortex-m3</a>      </li>
      <li class="navelem"><a class="el" href="dir_67d33e4ffe4ff938d746541f95b62a0f.html">drv</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">adc_sam3.c File Reference</div>  </div>
</div>
<div class="contents">

<p>ADC hardware-specific implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="adc__sam3_8h_source.html">adc_sam3.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cfg__adc_8h_source.html">cfg/cfg_adc.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="macros_8h_source.html">cfg/macros.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="compiler_8h_source.html">cfg/compiler.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="log_8h_source.html">cfg/log.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="adc_8h_source.html">drv/adc.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="irq__cm3_8h_source.html">drv/irq_cm3.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="cpu_2irq_8h_source.html">cpu/irq.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="event_8h_source.html">mware/event.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="cm3_8h_source.html">io/cm3.h</a>&gt;</code><br/>
</div>
<p><a href="adc__sam3_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="adc__sam3_8c.html#a495ae03b01c71a5b4768d26923cb777e">DECLARE_ISR</a> (adc_conversion_end_irq)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">ADC ISR.  <a href="#a495ae03b01c71a5b4768d26923cb777e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="adc__sam3_8c.html#a2654afcc53d07a0fe8677c5c64c94d60">adc_hw_select_ch</a> (uint8_t ch)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Select mux channel <em>ch</em>.  <a href="#a2654afcc53d07a0fe8677c5c64c94d60"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="adc__sam3_8c.html#af53cb85a56dda4aa7f95fc90e4d82069">adc_hw_read</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Start an ADC convertion.  <a href="#af53cb85a56dda4aa7f95fc90e4d82069"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af9c4563e46566bd0b8352ff64f792318"></a><!-- doxytag: member="adc_sam3.c::adc_hw_init" ref="af9c4563e46566bd0b8352ff64f792318" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="adc__sam3_8c.html#af9c4563e46566bd0b8352ff64f792318">adc_hw_init</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Init ADC hardware. <br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>ADC hardware-specific implementation. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Daniele Basile &lt;<a href="mailto:asterix@develer.com">asterix@develer.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="adc__sam3_8c_source.html">adc_sam3.c</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="af53cb85a56dda4aa7f95fc90e4d82069"></a><!-- doxytag: member="adc_sam3.c::adc_hw_read" ref="af53cb85a56dda4aa7f95fc90e4d82069" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t adc_hw_read </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start an ADC convertion. </p>
<p>If a kernel is present, preempt until convertion is complete, otherwise a busy wait on ADC_DRDY bit is done.</p>
<p>If a kernel is present, preempt until convertion is complete, otherwise a busy wait on ADCS bit is done. </p>

<p>Definition at line <a class="el" href="adc__sam3_8c_source.html#l00101">101</a> of file <a class="el" href="adc__sam3_8c_source.html">adc_sam3.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2654afcc53d07a0fe8677c5c64c94d60"></a><!-- doxytag: member="adc_sam3.c::adc_hw_select_ch" ref="a2654afcc53d07a0fe8677c5c64c94d60" args="(uint8_t ch)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adc_hw_select_ch </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Select mux channel <em>ch</em>. </p>
<p>Generally the stm32 cpu family allow us to program the order of adc channel that we want to read. In this driver implementation we put as fist channel to read the select ones. </p>

<p>Definition at line <a class="el" href="adc__sam3_8c_source.html#l00090">90</a> of file <a class="el" href="adc__sam3_8c_source.html">adc_sam3.c</a>.</p>

</div>
</div>
<a class="anchor" id="a495ae03b01c71a5b4768d26923cb777e"></a><!-- doxytag: member="adc_sam3.c::DECLARE_ISR" ref="a495ae03b01c71a5b4768d26923cb777e" args="(adc_conversion_end_irq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static DECLARE_ISR </td>
          <td>(</td>
          <td class="paramtype">adc_conversion_end_irq&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>ADC ISR. </p>
<p>The interrupt is connected to ready data, so when the adc ends the conversion we generate an event and then we return the converted value.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>to clear the Ready data bit and End of conversion bit we should read the Last Converted Data register, otherwise the ready data interrupt loop on this call. </dd></dl>

<p>Definition at line <a class="el" href="adc__sam3_8c_source.html#l00077">77</a> of file <a class="el" href="adc__sam3_8c_source.html">adc_sam3.c</a>.</p>

</div>
</div>
</div>


