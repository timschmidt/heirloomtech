

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_f7c89dbd63e8f34e572fe939945c15d7.html">drv</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">dataflash.h File Reference</div>  </div>
</div>
<div class="contents">

<p>Function library for dataflash AT45DB family.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="compiler_8h_source.html">cfg/compiler.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="io_2kfile_8h_source.html">io/kfile.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="battfs_8h_source.html">fs/battfs.h</a>&gt;</code><br/>
</div>
<p><a href="dataflash_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDataFlash.html">DataFlash</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Dataflash <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> context structure.  <a href="structDataFlash.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDataflashInfo.html">DataflashInfo</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure used to describe a dataflash memory.  <a href="structDataflashInfo.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aee6325d28cbc4fe0b7de904e0ee8dd72"></a><!-- doxytag: member="dataflash.h::KFT_DATAFLASH" ref="aee6325d28cbc4fe0b7de904e0ee8dd72" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#aee6325d28cbc4fe0b7de904e0ee8dd72">KFT_DATAFLASH</a>&#160;&#160;&#160;MAKE_ID('D', 'F', 'L', 'H')</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">ID for dataflash. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab8d07a2bf94d02c956096bf05bbc2ccb"></a><!-- doxytag: member="dataflash.h::RESET_PULSE_WIDTH" ref="ab8d07a2bf94d02c956096bf05bbc2ccb" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#ab8d07a2bf94d02c956096bf05bbc2ccb">RESET_PULSE_WIDTH</a>&#160;&#160;&#160;10</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Width of reset pulse in usec. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7e9eda34f27d379d599f1dc4cd837ff3"></a><!-- doxytag: member="dataflash.h::BUSY_BIT" ref="a7e9eda34f27d379d599f1dc4cd837ff3" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a7e9eda34f27d379d599f1dc4cd837ff3">BUSY_BIT</a>&#160;&#160;&#160;0x80</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Select a busy bit in status register. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af4afb3e4e91a9c205d9baf8c25a4f1e4"></a><!-- doxytag: member="dataflash.h::CMP_BIT" ref="af4afb3e4e91a9c205d9baf8c25a4f1e4" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#af4afb3e4e91a9c205d9baf8c25a4f1e4">CMP_BIT</a>&#160;&#160;&#160;0x40</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Select a compare bit in status register. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a4c41f17fb857b88db83bdfbc9eba34de">GET_ID_DESITY_DEVICE</a>(reg_stat)&#160;&#160;&#160;(((reg_stat) &amp; 0x3C) &gt;&gt; 2)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Select bits 2-5 of status register.  <a href="#a4c41f17fb857b88db83bdfbc9eba34de"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6736fa391e3a05f8b73c87291ff26640"></a><!-- doxytag: member="dataflash.h::dataflash_page_t" ref="a6736fa391e3a05f8b73c87291ff26640" args="" -->
typedef uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a6736fa391e3a05f8b73c87291ff26640">dataflash_page_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Type definitions for dflash memory. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a452e496b581ae3449b4f6a3886891424"></a><!-- doxytag: member="dataflash.h::dataflash_offset_t" ref="a452e496b581ae3449b4f6a3886891424" args="" -->
typedef uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a452e496b581ae3449b4f6a3886891424">dataflash_offset_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Type definitions for dflash memory. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9aa2cd64e8fd8bf19413f1dc61399006"></a><!-- doxytag: member="dataflash.h::dataflash_size_t" ref="a9aa2cd64e8fd8bf19413f1dc61399006" args="" -->
typedef uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a9aa2cd64e8fd8bf19413f1dc61399006">dataflash_size_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Type definitions for dflash memory. <br/></td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a734aa6956f6ea34cd612b934e3003675">DataflashType</a> </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory definitions.  <a href="dataflash_8h.html#a734aa6956f6ea34cd612b934e3003675">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92">DataFlashOpcode</a> { <br/>
&#160;&#160;<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ad036ed80a2a8a5958d251a0ba64427b7">DFO_READ_FLASH_MEM_BYTE_D</a> =  0x0B, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ade837679e682b7a7a33a1d793f5dbefb">DFO_READ_FLASH_MEM_BYTE_B</a> =  0xE8, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92aa74716949be82438035f8727ea652698">DFO_READ_FLASH_MEM</a> =  0xD2, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a0d98a778eeec8f2a37727e220586c964">DFO_READ_BUFF1</a> =  0xD4, 
<br/>
&#160;&#160;<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a267ea3d857a530aecf8c5cb66ab33a88">DFO_READ_BUFF2</a> =  0xD6, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a86a2a643712387e95d1c58f2c643ae0b">DFO_WRITE_BUFF1</a> =  0x84, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92acdaa6699eca2875fb53e0764b4efcdaa">DFO_WRITE_BUFF2</a> =  0x87, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ab5848665fc842321148e38bf58f27418">DFO_WRITE_BUFF1_TO_MEM_E</a> =  0x83, 
<br/>
&#160;&#160;<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ad1d72ae783c58b91f6f7da58f80ddfe1">DFO_WRITE_BUFF2_TO_MEM_E</a> =  0x86, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ab4c6b3fb7f4ace40fdeb2768e9dd50e6">DFO_WRITE_BUFF1_TO_MEM</a> =  0x88, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a6506d0b611f3a545ef2115db14c217ab">DFO_WRITE_BUFF2_TO_MEM</a> =  0x89, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a251e37030c9d752bca111bb186fe7a7c">DFO_ERASE_PAGE</a> =  0x81, 
<br/>
&#160;&#160;<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a109a8dac46e8e29af0dae03832cf8e84">DFO_ERASE_BLOCK</a> =  0x50, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ad2bb597693a212ee1700282b35911ba6">DFO_ERASE_SECTOR</a> =  0x7C, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a1430024d07e9d32ba59d7867470e9f52">DFO_WRITE_MEM_TR_BUFF1</a> =  0x82, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ae1956333505ba5814e264ec750ae9b8a">DFO_WRITE_MEM_TR_BUFF2</a> =  0x85, 
<br/>
&#160;&#160;<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a6bf8852f48ed4b34247b304789281836">DFO_MOV_MEM_TO_BUFF1</a> =  0x53, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ac5b2f67f2a7f5c73e0799ef64a37a888">DFO_MOV_MEM_TO_BUFF2</a> =  0x55, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a5acca40ba912817abafed7b90dbc18d5">DFO_CMP_MEM_TO_BUFF1</a> =  0x60, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ac93605f59b9790b9e612d732a396e11b">DFO_CMP_MEM_TO_BUFF2</a> =  0x61, 
<br/>
&#160;&#160;<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a2f4a992e644b366a5ee67903a608b0c7">DFO_ARW_MEM_TR_BUFF1</a> =  0x58, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a9308d7e463c3a14c20778bebf050f0e5">DFO_ARW_MEM_TR_BUFF2</a> =  0x59, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a885fd69d269b49687cda77a1bf6a1ce5">DFO_PWR_DOWN</a> =  0xB9, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92a1934ee73a529be582f41ccbe778cde27">DFO_RESUME_PWR_DOWN</a> =  0xAB, 
<br/>
&#160;&#160;<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ada7d1d4f9517b71a69b88b9ee322ae43">DFO_READ_STATUS</a> =  0xD7, 
<a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92ae062b0c6a9afba1dc1cfda98d2dd9003">DFO_ID_DEV</a> =  0x9F
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Data flash opcode commands.  <a href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a27dfcfa2c9aad38bde336138e1e12155"></a><!-- doxytag: member="dataflash.h::DATAFLASH_CAST" ref="a27dfcfa2c9aad38bde336138e1e12155" args="(KFile *fd)" -->
<a class="el" href="structDataFlash.html">DataFlash</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a27dfcfa2c9aad38bde336138e1e12155">DATAFLASH_CAST</a> (<a class="el" href="structKFile.html">KFile</a> *fd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert + ASSERT from generic <a class="el" href="structKFile.html" title="Context data for callback functions which operate on pseudo files.">KFile</a> to <a class="el" href="structDataFlash.html" title="Dataflash KFile context structure.">DataFlash</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#ad3acb10cdccc78f388b4a8fa85be8915">dataflash_init</a> (<a class="el" href="structDataFlash.html">DataFlash</a> *fd, <a class="el" href="structKFile.html">KFile</a> *ch, <a class="el" href="dataflash_8h.html#a734aa6956f6ea34cd612b934e3003675">DataflashType</a> type, dataflash_setCS_t *setCS, dataflash_setReset_t *setReset)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Dataflash init function.  <a href="#ad3acb10cdccc78f388b4a8fa85be8915"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a75673105711df5351b73e37c61c6ea6d">dataflash_testSetup</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">To test data falsh drive you could use this functions.  <a href="#a75673105711df5351b73e37c61c6ea6d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#aefd160bda57d4829ffbb3a4cd630ee6c">dataflash_testRun</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Run dataflash test memory.  <a href="#aefd160bda57d4829ffbb3a4cd630ee6c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dataflash_8h.html#a7d1d3b4a05a83bccf06a4a4d1408957b">dataflash_testTearDown</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">End a dataflash Test.  <a href="#a7d1d3b4a05a83bccf06a4a4d1408957b"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Function library for dataflash AT45DB family. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Daniele Basile &lt;<a href="mailto:asterix@develer.com">asterix@develer.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="dataflash_8h_source.html">dataflash.h</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a4c41f17fb857b88db83bdfbc9eba34de"></a><!-- doxytag: member="dataflash.h::GET_ID_DESITY_DEVICE" ref="a4c41f17fb857b88db83bdfbc9eba34de" args="(reg_stat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_ID_DESITY_DEVICE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">reg_stat</td><td>)</td>
          <td>&#160;&#160;&#160;(((reg_stat) &amp; 0x3C) &gt;&gt; 2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Select bits 2-5 of status register. </p>
<p>These bits indicate device density (see datasheet for more details). </p>

<p>Definition at line <a class="el" href="dataflash_8h_source.html#l00123">123</a> of file <a class="el" href="dataflash_8h_source.html">dataflash.h</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92"></a><!-- doxytag: member="dataflash.h::DataFlashOpcode" ref="a3cee1707173f93c4e2a23dd95bad4a92" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="dataflash_8h.html#a3cee1707173f93c4e2a23dd95bad4a92">DataFlashOpcode</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Data flash opcode commands. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ad036ed80a2a8a5958d251a0ba64427b7"></a><!-- doxytag: member="DFO_READ_FLASH_MEM_BYTE_D" ref="a3cee1707173f93c4e2a23dd95bad4a92ad036ed80a2a8a5958d251a0ba64427b7" args="" -->DFO_READ_FLASH_MEM_BYTE_D</em>&nbsp;</td><td>
<p>Dataflash read commands. </p>
<p>Continuos array read for D type memories. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ade837679e682b7a7a33a1d793f5dbefb"></a><!-- doxytag: member="DFO_READ_FLASH_MEM_BYTE_B" ref="a3cee1707173f93c4e2a23dd95bad4a92ade837679e682b7a7a33a1d793f5dbefb" args="" -->DFO_READ_FLASH_MEM_BYTE_B</em>&nbsp;</td><td>
<p>Continuos array read for B type memories. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92aa74716949be82438035f8727ea652698"></a><!-- doxytag: member="DFO_READ_FLASH_MEM" ref="a3cee1707173f93c4e2a23dd95bad4a92aa74716949be82438035f8727ea652698" args="" -->DFO_READ_FLASH_MEM</em>&nbsp;</td><td>
<p>Main memory page read. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a0d98a778eeec8f2a37727e220586c964"></a><!-- doxytag: member="DFO_READ_BUFF1" ref="a3cee1707173f93c4e2a23dd95bad4a92a0d98a778eeec8f2a37727e220586c964" args="" -->DFO_READ_BUFF1</em>&nbsp;</td><td>
<p>SRAM buffer 1 read. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a267ea3d857a530aecf8c5cb66ab33a88"></a><!-- doxytag: member="DFO_READ_BUFF2" ref="a3cee1707173f93c4e2a23dd95bad4a92a267ea3d857a530aecf8c5cb66ab33a88" args="" -->DFO_READ_BUFF2</em>&nbsp;</td><td>
<p>SRAM buffer 2 read. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a86a2a643712387e95d1c58f2c643ae0b"></a><!-- doxytag: member="DFO_WRITE_BUFF1" ref="a3cee1707173f93c4e2a23dd95bad4a92a86a2a643712387e95d1c58f2c643ae0b" args="" -->DFO_WRITE_BUFF1</em>&nbsp;</td><td>
<p>Program and erase commands data flash. </p>
<p>SRAM buffer 1 write. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92acdaa6699eca2875fb53e0764b4efcdaa"></a><!-- doxytag: member="DFO_WRITE_BUFF2" ref="a3cee1707173f93c4e2a23dd95bad4a92acdaa6699eca2875fb53e0764b4efcdaa" args="" -->DFO_WRITE_BUFF2</em>&nbsp;</td><td>
<p>SRAM buffer 2 write. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ab5848665fc842321148e38bf58f27418"></a><!-- doxytag: member="DFO_WRITE_BUFF1_TO_MEM_E" ref="a3cee1707173f93c4e2a23dd95bad4a92ab5848665fc842321148e38bf58f27418" args="" -->DFO_WRITE_BUFF1_TO_MEM_E</em>&nbsp;</td><td>
<p>Buffer 1 to main memory page program with built-in erase. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ad1d72ae783c58b91f6f7da58f80ddfe1"></a><!-- doxytag: member="DFO_WRITE_BUFF2_TO_MEM_E" ref="a3cee1707173f93c4e2a23dd95bad4a92ad1d72ae783c58b91f6f7da58f80ddfe1" args="" -->DFO_WRITE_BUFF2_TO_MEM_E</em>&nbsp;</td><td>
<p>Buffer 2 to main memory page program with built-in erase. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ab4c6b3fb7f4ace40fdeb2768e9dd50e6"></a><!-- doxytag: member="DFO_WRITE_BUFF1_TO_MEM" ref="a3cee1707173f93c4e2a23dd95bad4a92ab4c6b3fb7f4ace40fdeb2768e9dd50e6" args="" -->DFO_WRITE_BUFF1_TO_MEM</em>&nbsp;</td><td>
<p>Buffer 1 to main memory page program without built-in erase. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a6506d0b611f3a545ef2115db14c217ab"></a><!-- doxytag: member="DFO_WRITE_BUFF2_TO_MEM" ref="a3cee1707173f93c4e2a23dd95bad4a92a6506d0b611f3a545ef2115db14c217ab" args="" -->DFO_WRITE_BUFF2_TO_MEM</em>&nbsp;</td><td>
<p>Buffer 2 to main memory page program without built-in erase. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a251e37030c9d752bca111bb186fe7a7c"></a><!-- doxytag: member="DFO_ERASE_PAGE" ref="a3cee1707173f93c4e2a23dd95bad4a92a251e37030c9d752bca111bb186fe7a7c" args="" -->DFO_ERASE_PAGE</em>&nbsp;</td><td>
<p>Erase page. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a109a8dac46e8e29af0dae03832cf8e84"></a><!-- doxytag: member="DFO_ERASE_BLOCK" ref="a3cee1707173f93c4e2a23dd95bad4a92a109a8dac46e8e29af0dae03832cf8e84" args="" -->DFO_ERASE_BLOCK</em>&nbsp;</td><td>
<p>Erase block. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ad2bb597693a212ee1700282b35911ba6"></a><!-- doxytag: member="DFO_ERASE_SECTOR" ref="a3cee1707173f93c4e2a23dd95bad4a92ad2bb597693a212ee1700282b35911ba6" args="" -->DFO_ERASE_SECTOR</em>&nbsp;</td><td>
<p>Erase sector. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a1430024d07e9d32ba59d7867470e9f52"></a><!-- doxytag: member="DFO_WRITE_MEM_TR_BUFF1" ref="a3cee1707173f93c4e2a23dd95bad4a92a1430024d07e9d32ba59d7867470e9f52" args="" -->DFO_WRITE_MEM_TR_BUFF1</em>&nbsp;</td><td>
<p>Write main memory page through buffer 1. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ae1956333505ba5814e264ec750ae9b8a"></a><!-- doxytag: member="DFO_WRITE_MEM_TR_BUFF2" ref="a3cee1707173f93c4e2a23dd95bad4a92ae1956333505ba5814e264ec750ae9b8a" args="" -->DFO_WRITE_MEM_TR_BUFF2</em>&nbsp;</td><td>
<p>Write main memory page through buffer 2. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a6bf8852f48ed4b34247b304789281836"></a><!-- doxytag: member="DFO_MOV_MEM_TO_BUFF1" ref="a3cee1707173f93c4e2a23dd95bad4a92a6bf8852f48ed4b34247b304789281836" args="" -->DFO_MOV_MEM_TO_BUFF1</em>&nbsp;</td><td>
<p>Additional dataflash commands. </p>
<p>Transfer main mmemory to buffer 1. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ac5b2f67f2a7f5c73e0799ef64a37a888"></a><!-- doxytag: member="DFO_MOV_MEM_TO_BUFF2" ref="a3cee1707173f93c4e2a23dd95bad4a92ac5b2f67f2a7f5c73e0799ef64a37a888" args="" -->DFO_MOV_MEM_TO_BUFF2</em>&nbsp;</td><td>
<p>Transfer main mmemory to buffer 2. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a5acca40ba912817abafed7b90dbc18d5"></a><!-- doxytag: member="DFO_CMP_MEM_TO_BUFF1" ref="a3cee1707173f93c4e2a23dd95bad4a92a5acca40ba912817abafed7b90dbc18d5" args="" -->DFO_CMP_MEM_TO_BUFF1</em>&nbsp;</td><td>
<p>Compare main mmemory with buffer 1. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ac93605f59b9790b9e612d732a396e11b"></a><!-- doxytag: member="DFO_CMP_MEM_TO_BUFF2" ref="a3cee1707173f93c4e2a23dd95bad4a92ac93605f59b9790b9e612d732a396e11b" args="" -->DFO_CMP_MEM_TO_BUFF2</em>&nbsp;</td><td>
<p>Compare main mmemory with buffer 2. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a2f4a992e644b366a5ee67903a608b0c7"></a><!-- doxytag: member="DFO_ARW_MEM_TR_BUFF1" ref="a3cee1707173f93c4e2a23dd95bad4a92a2f4a992e644b366a5ee67903a608b0c7" args="" -->DFO_ARW_MEM_TR_BUFF1</em>&nbsp;</td><td>
<p>Auto page rewrite through buffer 1. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a9308d7e463c3a14c20778bebf050f0e5"></a><!-- doxytag: member="DFO_ARW_MEM_TR_BUFF2" ref="a3cee1707173f93c4e2a23dd95bad4a92a9308d7e463c3a14c20778bebf050f0e5" args="" -->DFO_ARW_MEM_TR_BUFF2</em>&nbsp;</td><td>
<p>Auto page rewrite through buffer 2. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a885fd69d269b49687cda77a1bf6a1ce5"></a><!-- doxytag: member="DFO_PWR_DOWN" ref="a3cee1707173f93c4e2a23dd95bad4a92a885fd69d269b49687cda77a1bf6a1ce5" args="" -->DFO_PWR_DOWN</em>&nbsp;</td><td>
<p>Deep power-down. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92a1934ee73a529be582f41ccbe778cde27"></a><!-- doxytag: member="DFO_RESUME_PWR_DOWN" ref="a3cee1707173f93c4e2a23dd95bad4a92a1934ee73a529be582f41ccbe778cde27" args="" -->DFO_RESUME_PWR_DOWN</em>&nbsp;</td><td>
<p>Resume from deep power-down. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ada7d1d4f9517b71a69b88b9ee322ae43"></a><!-- doxytag: member="DFO_READ_STATUS" ref="a3cee1707173f93c4e2a23dd95bad4a92ada7d1d4f9517b71a69b88b9ee322ae43" args="" -->DFO_READ_STATUS</em>&nbsp;</td><td>
<p>Read status register. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3cee1707173f93c4e2a23dd95bad4a92ae062b0c6a9afba1dc1cfda98d2dd9003"></a><!-- doxytag: member="DFO_ID_DEV" ref="a3cee1707173f93c4e2a23dd95bad4a92ae062b0c6a9afba1dc1cfda98d2dd9003" args="" -->DFO_ID_DEV</em>&nbsp;</td><td>
<p>Read manufacturer and device ID. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="dataflash_8h_source.html#l00128">128</a> of file <a class="el" href="dataflash_8h_source.html">dataflash.h</a>.</p>

</div>
</div>
<a class="anchor" id="a734aa6956f6ea34cd612b934e3003675"></a><!-- doxytag: member="dataflash.h::DataflashType" ref="a734aa6956f6ea34cd612b934e3003675" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="dataflash_8h.html#a734aa6956f6ea34cd612b934e3003675">DataflashType</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Memory definitions. </p>
<p><a class="el" href="structList.html" title="Head of a doubly-linked list of Node structs.">List</a> of supported memory devices by this drive. Every time we call <a class="el" href="dataflash_8c.html#a524d11c33d73a33947a089d9bfe6bfc7" title="Dataflash init function.">dataflash_init()</a> we check device id to ensure we choose the right memory configuration. (see <a class="el" href="dataflash_8c.html" title="Function library for dataflash AT45DB family (implementation).">dataflash.c</a> for more details). </p>

<p>Definition at line <a class="el" href="dataflash_8h_source.html#l00076">76</a> of file <a class="el" href="dataflash_8h_source.html">dataflash.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ad3acb10cdccc78f388b4a8fa85be8915"></a><!-- doxytag: member="dataflash.h::dataflash_init" ref="ad3acb10cdccc78f388b4a8fa85be8915" args="(DataFlash *fd, KFile *ch, DataflashType type, dataflash_setCS_t *setCS, dataflash_setReset_t *setReset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dataflash_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDataFlash.html">DataFlash</a> *&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structKFile.html">KFile</a> *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="dataflash_8h.html#a734aa6956f6ea34cd612b934e3003675">DataflashType</a>&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dataflash_setCS_t *&#160;</td>
          <td class="paramname"><em>setCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dataflash_setReset_t *&#160;</td>
          <td class="paramname"><em>setReset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dataflash init function. </p>
<p>This function initialize <em>fd</em> with SPI channel <em>ch</em> and test if data flash memory density is the same specified by device <em>dev</em>. <em>setCS</em> is a callback used to set/reset CS line. <em>setReset</em> is a callback used to set/reset the dataflash (can be NULL if reset is unconnected) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if ok, false if memory density read from dataflash is not compliant with the configured one. </dd></dl>

<p>Definition at line <a class="el" href="dataflash_8c_source.html#l00545">545</a> of file <a class="el" href="dataflash_8c_source.html">dataflash.c</a>.</p>

</div>
</div>
<a class="anchor" id="aefd160bda57d4829ffbb3a4cd630ee6c"></a><!-- doxytag: member="dataflash.h::dataflash_testRun" ref="aefd160bda57d4829ffbb3a4cd630ee6c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dataflash_testRun </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Run dataflash test memory. </p>

<p>Definition at line <a class="el" href="dataflash__hwtest_8c_source.html#l00170">170</a> of file <a class="el" href="dataflash__hwtest_8c_source.html">dataflash_hwtest.c</a>.</p>

</div>
</div>
<a class="anchor" id="a75673105711df5351b73e37c61c6ea6d"></a><!-- doxytag: member="dataflash.h::dataflash_testSetup" ref="a75673105711df5351b73e37c61c6ea6d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dataflash_testSetup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>To test data falsh drive you could use this functions. </p>
<p>To use these functions make sure to include in your make file the drv/datafalsh_test.c source.</p>
<p>(see drv/datafalsh_test.c for more detail) </p>

<p>Definition at line <a class="el" href="dataflash__hwtest_8c_source.html#l00110">110</a> of file <a class="el" href="dataflash__hwtest_8c_source.html">dataflash_hwtest.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7d1d3b4a05a83bccf06a4a4d1408957b"></a><!-- doxytag: member="dataflash.h::dataflash_testTearDown" ref="a7d1d3b4a05a83bccf06a4a4d1408957b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dataflash_testTearDown </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>End a dataflash Test. </p>
<p>(Unused) </p>

<p>Definition at line <a class="el" href="dataflash__hwtest_8c_source.html#l00192">192</a> of file <a class="el" href="dataflash__hwtest_8c_source.html">dataflash_hwtest.c</a>.</p>

</div>
</div>
</div>


