

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_5b85ff6a72c79a71106598e13514bf0c.html">mware</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">parser.h</div>  </div>
</div>
<div class="contents">
<a href="parser_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00115"></a>00115 <span class="preprocessor">#ifndef MWARE_PARSER_H</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span><span class="preprocessor">#define MWARE_PARSER_H</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>
<a name="l00118"></a>00118 <span class="preprocessor">#include &quot;<a class="code" href="cfg__parser_8h.html" title="Configuration file for parser module.">cfg/cfg_parser.h</a>&quot;</span>
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="preprocessor">#include &lt;<a class="code" href="types_8h.html" title="CPU-specific type definitions.">cpu/types.h</a>&gt;</span>
<a name="l00121"></a>00121 <span class="preprocessor">#include &lt;<a class="code" href="debug_8h.html">cfg/debug.h</a>&gt;</span>
<a name="l00122"></a>00122 
<a name="l00126"></a><a class="code" href="group__parser.html#gad8097859ab1bdd06be52a8421df152d4">00126</a> <span class="keyword">typedef</span> <span class="keyword">enum</span>
<a name="l00127"></a>00127 {
<a name="l00128"></a><a class="code" href="group__parser.html#ggad8097859ab1bdd06be52a8421df152d4aae4a23b560d56fcf0981a9636f58edeb">00128</a>     <a class="code" href="group__parser.html#ggad8097859ab1bdd06be52a8421df152d4aae4a23b560d56fcf0981a9636f58edeb" title="Reply with error.">RC_ERROR</a>  = -1, 
<a name="l00129"></a><a class="code" href="group__parser.html#ggad8097859ab1bdd06be52a8421df152d4ab834a5bb2ce6d97c2831fe3d71103c14">00129</a>     <a class="code" href="group__parser.html#ggad8097859ab1bdd06be52a8421df152d4ab834a5bb2ce6d97c2831fe3d71103c14" title="No reply (ignore reply arguments).">RC_OK</a>     = 0,  
<a name="l00130"></a><a class="code" href="group__parser.html#ggad8097859ab1bdd06be52a8421df152d4a71c73247221c21b225a9349c87ded3ed">00130</a>     <a class="code" href="group__parser.html#ggad8097859ab1bdd06be52a8421df152d4a71c73247221c21b225a9349c87ded3ed" title="Reply command arguments.">RC_REPLY</a>  = 1,  
<a name="l00131"></a><a class="code" href="group__parser.html#ggad8097859ab1bdd06be52a8421df152d4a94d7240246d2247a113a4f1ed0686c3b">00131</a>     <a class="code" href="group__parser.html#ggad8097859ab1bdd06be52a8421df152d4a94d7240246d2247a113a4f1ed0686c3b" title="Skip following commands.">RC_SKIP</a>   = 2   
<a name="l00132"></a>00132 } <a class="code" href="group__parser.html#gad8097859ab1bdd06be52a8421df152d4" title="Error generated by the commands through the return code.">ResultCode</a>;
<a name="l00133"></a>00133 
<a name="l00135"></a><a class="code" href="unionparms.html">00135</a> <span class="keyword">typedef</span> <span class="keyword">union </span>{ <span class="keywordtype">long</span> l; <span class="keyword">const</span> <span class="keywordtype">char</span> *s; } <a class="code" href="unionparms.html" title="union that contains parameters passed to and from commands">parms</a>;
<a name="l00137"></a><a class="code" href="group__parser.html#gac1eee8060fb5c38f9c47559242cf5658">00137</a> <span class="keyword">typedef</span> <a class="code" href="group__parser.html#gad8097859ab1bdd06be52a8421df152d4" title="Error generated by the commands through the return code.">ResultCode</a> (*<a class="code" href="group__parser.html#gac1eee8060fb5c38f9c47559242cf5658" title="pointer to commands">CmdFuncPtr</a>)(<a class="code" href="unionparms.html" title="union that contains parameters passed to and from commands">parms</a> args_results[]);
<a name="l00138"></a>00138 
<a name="l00151"></a><a class="code" href="structCmdTemplate.html">00151</a> <span class="keyword">struct </span><a class="code" href="structCmdTemplate.html" title="Define a command that can be tokenized by the parser.">CmdTemplate</a>
<a name="l00152"></a>00152 {
<a name="l00153"></a><a class="code" href="structCmdTemplate.html#a6d5ccfbe3e0e458952d2ff8d415a1b2a">00153</a>     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structCmdTemplate.html#a6d5ccfbe3e0e458952d2ff8d415a1b2a" title="Name of command.">name</a>;          
<a name="l00154"></a><a class="code" href="structCmdTemplate.html#a77c8d663e19e5110bc163ff818e11638">00154</a>     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structCmdTemplate.html#a77c8d663e19e5110bc163ff818e11638" title="Format string for the input.">arg_fmt</a>;       
<a name="l00155"></a><a class="code" href="structCmdTemplate.html#a6bcb49aa9084c9d6352da83e801c1b8b">00155</a>     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structCmdTemplate.html#a6bcb49aa9084c9d6352da83e801c1b8b" title="Format string for the output.">result_fmt</a>;    
<a name="l00156"></a><a class="code" href="structCmdTemplate.html#ac495c44742635e75e41f656696c98f83">00156</a>     <a class="code" href="group__parser.html#gac1eee8060fb5c38f9c47559242cf5658" title="pointer to commands">CmdFuncPtr</a> <a class="code" href="structCmdTemplate.html#ac495c44742635e75e41f656696c98f83" title="Pointer to the handler function.">func</a>;           
<a name="l00157"></a><a class="code" href="structCmdTemplate.html#aa8f6e6a5201f7240eb96203cf2bae15e">00157</a>     uint16_t   <a class="code" href="structCmdTemplate.html#aa8f6e6a5201f7240eb96203cf2bae15e" title="Currently unused.">flags</a>;          
<a name="l00158"></a>00158 };
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="preprocessor">#define REGISTER_FUNCTION parser_register_cmd</span>
<a name="l00161"></a>00161 <span class="preprocessor"></span>
<a name="l00167"></a><a class="code" href="group__parser.html#gacced74394dff2418fee7f190d5546fb6">00167</a> <span class="preprocessor">#define REGISTER_CMD(NAME) \</span>
<a name="l00168"></a>00168 <span class="preprocessor">    do { \</span>
<a name="l00169"></a>00169 <span class="preprocessor">        if (!REGISTER_FUNCTION(&amp;cmd_ ## NAME ## _template)) \</span>
<a name="l00170"></a>00170 <span class="preprocessor">            ASSERT2(0, &quot;Error in registering command, no space left&quot;); \</span>
<a name="l00171"></a>00171 <span class="preprocessor">    } while (0)</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span>
<a name="l00183"></a><a class="code" href="group__parser.html#ga943d2fbf932f80b6a52f374bb712e2ae">00183</a> <span class="preprocessor">#define MAKE_TEMPLATE(NAME, ARGS, RES, FLAGS)          \</span>
<a name="l00184"></a>00184 <span class="preprocessor">const struct CmdTemplate cmd_ ## NAME ## _template =   \</span>
<a name="l00185"></a>00185 <span class="preprocessor">{                                                      \</span>
<a name="l00186"></a>00186 <span class="preprocessor">    #NAME, ARGS, RES, cmd_ ## NAME, FLAGS          \</span>
<a name="l00187"></a>00187 <span class="preprocessor">};</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span>
<a name="l00213"></a><a class="code" href="group__parser.html#gade7a82f845459cea37bb02c48abff4fa">00213</a> <span class="preprocessor">#define MAKE_CMD(NAME, ARGS, RES, BODY, FLAGS)  \</span>
<a name="l00214"></a>00214 <span class="preprocessor">static ResultCode cmd_ ## NAME (parms *args)    \</span>
<a name="l00215"></a>00215 <span class="preprocessor">{                                               \</span>
<a name="l00216"></a>00216 <span class="preprocessor">    return (ResultCode)BODY;                \</span>
<a name="l00217"></a>00217 <span class="preprocessor">}                                               \</span>
<a name="l00218"></a>00218 <span class="preprocessor">MAKE_TEMPLATE(NAME, ARGS, RES, FLAGS)</span>
<a name="l00219"></a>00219 <span class="preprocessor"></span>
<a name="l00225"></a>00225 <span class="keywordtype">void</span> <a class="code" href="group__parser.html#ga412e2a44f5de56422d2c62bbae3685d0" title="Initialize the parser module.">parser_init</a>(<span class="keywordtype">void</span>);
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="keywordtype">bool</span> <a class="code" href="group__parser.html#gad5eec249e05ec5cadcde55382291773d" title="Register a new command into the parser.">parser_register_cmd</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structCmdTemplate.html" title="Define a command that can be tokenized by the parser.">CmdTemplate</a>* cmd);
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 
<a name="l00237"></a>00237 <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="parser_8c.html#a756e545c00b74d876d560e806423bb99" title="Hook provided by the parser for matching of command names (TAB completion) for readline.">parser_rl_match</a>(<span class="keywordtype">void</span>* dummy, <span class="keyword">const</span> <span class="keywordtype">char</span>* word, <span class="keywordtype">int</span> word_len);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 <span class="keywordtype">bool</span> <a class="code" href="group__parser.html#gaea5ddc7bf6470ada78b70f24c369b16d" title="Command input handler.">parser_process_line</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* line);
<a name="l00240"></a>00240 
<a name="l00252"></a><a class="code" href="group__parser.html#gae48733c2c44a2c5bcd56cd910aacae0e">00252</a> INLINE <span class="keywordtype">bool</span> <a class="code" href="group__parser.html#gae48733c2c44a2c5bcd56cd910aacae0e" title="Execute a command with its arguments, and fetch its results.">parser_execute_cmd</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structCmdTemplate.html" title="Define a command that can be tokenized by the parser.">CmdTemplate</a>* templ, <a class="code" href="unionparms.html" title="union that contains parameters passed to and from commands">parms</a> args[<a class="code" href="cfg__parser_8h.html#a3abbab212e747ab121b5dbf9ed2f46c3" title="Max number of arguments and results for each command.">CONFIG_PARSER_MAX_ARGS</a>])
<a name="l00253"></a>00253 {
<a name="l00254"></a>00254     <span class="keywordflow">return</span> (templ-&gt;<a class="code" href="structCmdTemplate.html#ac495c44742635e75e41f656696c98f83" title="Pointer to the handler function.">func</a>(args) == 0);
<a name="l00255"></a>00255 }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structCmdTemplate.html" title="Define a command that can be tokenized by the parser.">CmdTemplate</a>* <a class="code" href="group__parser.html#gac607092de13a1f01e3c9c34d5cfb8ad2" title="Find the template for the command contained in the text line.">parser_get_cmd_template</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* line);
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 <span class="keywordtype">bool</span> <a class="code" href="group__parser.html#gaef65813364192b283dc9dbbf7915eaaf" title="Extract the arguments for the command contained in the text line.">parser_get_cmd_arguments</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* line, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structCmdTemplate.html" title="Define a command that can be tokenized by the parser.">CmdTemplate</a>* templ, <a class="code" href="unionparms.html" title="union that contains parameters passed to and from commands">parms</a> args[<a class="code" href="cfg__parser_8h.html#a3abbab212e747ab121b5dbf9ed2f46c3" title="Max number of arguments and results for each command.">CONFIG_PARSER_MAX_ARGS</a>]);
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 <span class="preprocessor">#if CONFIG_ENABLE_COMPAT_BEHAVIOUR</span>
<a name="l00262"></a>00262 <span class="preprocessor"></span>
<a name="l00271"></a>00271 <span class="keywordtype">bool</span> parser_get_cmd_id(<span class="keyword">const</span> <span class="keywordtype">char</span>* line, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>* ID);
<a name="l00272"></a>00272 <span class="preprocessor">#endif</span>
<a name="l00273"></a>00273 <span class="preprocessor"></span>
<a name="l00274"></a>00274  <span class="comment">// defgroup parser</span>
<a name="l00276"></a>00276 <span class="preprocessor">#endif </span><span class="comment">/* MWARE_PARSER_H */</span>
<a name="l00277"></a>00277 
</pre></div></div>
</div>


