

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_8751e12fe1becf196f093883e557854f.html">struct</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">heap.h</div>  </div>
</div>
<div class="contents">
<a href="heap_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00049"></a>00049 <span class="preprocessor">#ifndef STRUCT_HEAP_H</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">#define STRUCT_HEAP_H</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="cfg__heap_8h.html" title="Configuration file for heap module.">cfg/cfg_heap.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;<a class="code" href="compiler_8h.html" title="Additional support macros for compiler independance.">cfg/compiler.h</a>&gt;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &lt;<a class="code" href="macros_8h.html">cfg/macros.h</a>&gt;</span> <span class="comment">// IS_POW2()</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">/* NOTE: struct size must be a 2&#39;s power! */</span>
<a name="l00057"></a>00057 <span class="keyword">typedef</span> <span class="keyword">struct </span>_MemChunk
<a name="l00058"></a>00058 {
<a name="l00059"></a>00059     <span class="keyword">struct </span>_MemChunk *next;
<a name="l00060"></a>00060     <span class="keywordtype">size_t</span> size;
<a name="l00061"></a>00061 } MemChunk;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <a class="code" href="compiler_8h.html#a695e64485eb9535f5ddcfec01167bddc" title="Issue a compilation error if the condition is false.">STATIC_ASSERT</a>(<a class="code" href="group__macros.html#gafd922d5a863aa3844c5390af42d97638" title="Check if x is an integer power of 2.">IS_POW2</a>(<span class="keyword">sizeof</span>(MemChunk)));
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="keyword">typedef</span> MemChunk heap_buf_t;
<a name="l00066"></a>00066 
<a name="l00068"></a><a class="code" href="structHeap.html">00068</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structHeap.html" title="A heap.">Heap</a>
<a name="l00069"></a>00069 {
<a name="l00070"></a><a class="code" href="structHeap.html#a0096b7bbba9de9cbf35cd61d5e3e12c4">00070</a>     <span class="keyword">struct </span>_MemChunk *<a class="code" href="structHeap.html#a0096b7bbba9de9cbf35cd61d5e3e12c4" title="Head of the free list.">FreeList</a>;     
<a name="l00071"></a>00071 } <a class="code" href="structHeap.html" title="A heap.">Heap</a>;
<a name="l00072"></a>00072 
<a name="l00079"></a><a class="code" href="group__heap.html#gade2fd903de6ec7b63bd94c3d69e16738">00079</a> <span class="preprocessor">#define HEAP_DEFINE_BUF(name, size) \</span>
<a name="l00080"></a>00080 <span class="preprocessor">    heap_buf_t name[((size) + sizeof(heap_buf_t) - 1) / sizeof(heap_buf_t)]</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span>
<a name="l00083"></a>00083 <span class="keywordtype">void</span> <a class="code" href="group__heap.html#gaf4f2dae105fba77662c3039da6599826" title="Initialize heap within the buffer pointed by memory which is of size bytes.">heap_init</a>(<span class="keyword">struct</span> <a class="code" href="structHeap.html" title="A heap.">Heap</a>* heap, <span class="keywordtype">void</span>* memory, <span class="keywordtype">size_t</span> size);
<a name="l00084"></a>00084 
<a name="l00086"></a>00086 <span class="keywordtype">void</span> *<a class="code" href="group__heap.html#ga923bf16a38f836d6dde965422f2af181" title="Allocate a chunk of memory of size bytes from the heap.">heap_allocmem</a>(<span class="keyword">struct</span> <a class="code" href="structHeap.html" title="A heap.">Heap</a>* heap, <span class="keywordtype">size_t</span> size);
<a name="l00087"></a>00087 
<a name="l00089"></a>00089 <span class="keywordtype">void</span> <a class="code" href="group__heap.html#gaeeeb69beffe6368c2d1129895d13168d" title="Free a chunk of memory of size bytes from the heap.">heap_freemem</a>(<span class="keyword">struct</span> <a class="code" href="structHeap.html" title="A heap.">Heap</a>* heap, <span class="keywordtype">void</span> *mem, <span class="keywordtype">size_t</span> size);
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="keywordtype">size_t</span> <a class="code" href="group__heap.html#ga94fae92fb177605c541ddaf12aa4dd09" title="Returns the number of free bytes in a heap.">heap_freeSpace</a>(<span class="keyword">struct</span> <a class="code" href="structHeap.html" title="A heap.">Heap</a> *h);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="preprocessor">#define HNEW(heap, type) \</span>
<a name="l00094"></a>00094 <span class="preprocessor">    (type*)heap_allocmem(heap, sizeof(type))</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span>
<a name="l00096"></a>00096 <span class="preprocessor">#define HNEWVEC(heap, type, nelem) \</span>
<a name="l00097"></a>00097 <span class="preprocessor">    (type*)heap_allocmem(heap, sizeof(type) * (nelem))</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>
<a name="l00099"></a>00099 <span class="preprocessor">#define HDELETE(heap, type, mem) \</span>
<a name="l00100"></a>00100 <span class="preprocessor">    heap_freemem(heap, mem, sizeof(type))</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span>
<a name="l00102"></a>00102 <span class="preprocessor">#define HDELETEVEC(heap, type, nelem, mem) \</span>
<a name="l00103"></a>00103 <span class="preprocessor">    heap_freemem(heap, mem, sizeof(type) * (nelem))</span>
<a name="l00104"></a>00104 <span class="preprocessor"></span>
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="preprocessor">#if CONFIG_HEAP_MALLOC</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span>
<a name="l00112"></a>00112 <span class="keywordtype">void</span> *<a class="code" href="group__heap.html#gae778acf9b11af6b2b0c2272480db9fcb" title="Standard malloc interface.">heap_malloc</a>(<span class="keyword">struct</span> <a class="code" href="structHeap.html" title="A heap.">Heap</a>* heap, <span class="keywordtype">size_t</span> size);
<a name="l00113"></a>00113 <span class="keywordtype">void</span> *<a class="code" href="group__heap.html#ga3db8b9bd6fd83aa6c9a3ddace0342876" title="Standard calloc interface.">heap_calloc</a>(<span class="keyword">struct</span> <a class="code" href="structHeap.html" title="A heap.">Heap</a>* heap, <span class="keywordtype">size_t</span> size);
<a name="l00114"></a>00114 <span class="keywordtype">void</span> <a class="code" href="group__heap.html#gab6738546cec6c556f7d5d08527c9c4e9" title="Free a block of memory, determining its size automatically.">heap_free</a>(<span class="keyword">struct</span> <a class="code" href="structHeap.html" title="A heap.">Heap</a>* heap, <span class="keywordtype">void</span> * mem);
<a name="l00117"></a>00117 <span class="preprocessor">#endif</span>
<a name="l00118"></a>00118 <span class="preprocessor"></span> <span class="comment">//defgroup heap</span>
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="keywordtype">int</span> heap_testSetup(<span class="keywordtype">void</span>);
<a name="l00122"></a>00122 <span class="keywordtype">int</span> heap_testRun(<span class="keywordtype">void</span>);
<a name="l00123"></a>00123 <span class="keywordtype">int</span> heap_testTearDown(<span class="keywordtype">void</span>);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 <span class="preprocessor">#endif </span><span class="comment">/* STRUCT_HEAP_H */</span>
</pre></div></div>
</div>


