

<!-- Generated by Doxygen 1.7.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_9fd71c1ac00056e7d855336b2291c56c.html">bertos</a>      </li>
      <li class="navelem"><a class="el" href="dir_f7c89dbd63e8f34e572fe939945c15d7.html">drv</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ntc.c File Reference</div>  </div>
</div>
<div class="contents">

<p>Driver for NTC (reads a temperature through an ADC)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="hw__ntc_8h_source.html">hw/hw_ntc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ntc__map_8h_source.html">hw/ntc_map.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cfg__ntc_8h_source.html">cfg/cfg_ntc.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="log_8h_source.html">cfg/log.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="debug_8h_source.html">cfg/debug.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="ntc_8h_source.html">drv/ntc.h</a>&gt;</code><br/>
</div>
<p><a href="ntc_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntc_8c.html#ae8d12fc697ce2905644bb558dc6fc647">upper_bound</a> (const res_t *orig_table, size_t size, res_t val)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Find in a table of values <em>orig_table</em> of size <em>size</em>, the index which value is less or equal to <em>val</em>.  <a href="#ae8d12fc697ce2905644bb558dc6fc647"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">deg_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntc_8c.html#a94c372924ed335acd89d59442d6554af">ntc_read</a> (NtcDev dev)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the temperature for the NTC channel <em>dev</em>.  <a href="#a94c372924ed335acd89d59442d6554af"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ntc_8c.html#a7c5b4d092d8a2de58d6788b3a8ef573b">ntc_init</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Init NTC hardware.  <a href="#a7c5b4d092d8a2de58d6788b3a8ef573b"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Driver for NTC (reads a temperature through an ADC) </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Giovanni Bajo &lt;<a href="mailto:rasky@develer.com">rasky@develer.com</a>&gt; </dd>
<dd>
Francesco Sacchi &lt;<a href="mailto:batt@develer.com">batt@develer.com</a>&gt;</dd></dl>
<p>This module handles an external NTC bound to an AD converter. As usual, it relies on a low-level API (ntc_hw_*) (see below): </p>

<p>Definition in file <a class="el" href="ntc_8c_source.html">ntc.c</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7c5b4d092d8a2de58d6788b3a8ef573b"></a><!-- doxytag: member="ntc.c::ntc_init" ref="a7c5b4d092d8a2de58d6788b3a8ef573b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ntc_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Init NTC hardware. </p>
<p>Initialize the NTC module. </p>

<p>Definition at line <a class="el" href="ntc_8c_source.html#l00149">149</a> of file <a class="el" href="ntc_8c_source.html">ntc.c</a>.</p>

</div>
</div>
<a class="anchor" id="a94c372924ed335acd89d59442d6554af"></a><!-- doxytag: member="ntc.c::ntc_read" ref="a94c372924ed335acd89d59442d6554af" args="(NtcDev dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">deg_t ntc_read </td>
          <td>(</td>
          <td class="paramtype">NtcDev&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read the temperature for the NTC channel <em>dev</em>. </p>
<p>Read a single temperature value from the NTC.</p>
<p>First read the resistence of the NTC through <a class="el" href="hw__ntc_8h.html#a84fdb9b47a0d58ccc41f0371d9a1fa2d">ntc_hw_read()</a>, then, for the conversion from resistance to temperature, since the formula varies from device to device, we implemented a generic system using a table of data which maps temperature (index) to resistance (data). The range of the table (min/max temperature) and the step (temperature difference between two consecutive elements of the table) is variable and can be specified. Notice that values inbetween the table elements are still possible as the library does a linear interpolation using the actual calculated resistance to find out the exact temperature.</p>
<p>The low-level API provides a function to get access to a description of the NTC (<a class="el" href="hw__ntc_8h.html#af641aaa3a24103576e5fa27db935c92e">ntc_hw_getInfo()</a>), including the resistance table. </p>

<p>Definition at line <a class="el" href="ntc_8c_source.html#l00104">104</a> of file <a class="el" href="ntc_8c_source.html">ntc.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae8d12fc697ce2905644bb558dc6fc647"></a><!-- doxytag: member="ntc.c::upper_bound" ref="ae8d12fc697ce2905644bb558dc6fc647" args="(const res_t *orig_table, size_t size, res_t val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static size_t upper_bound </td>
          <td>(</td>
          <td class="paramtype">const res_t *&#160;</td>
          <td class="paramname"><em>orig_table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">res_t&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find in a table of values <em>orig_table</em> of size <em>size</em>, the index which value is less or equal to <em>val</em>. </p>
<dl><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>When <em>val</em> is higher than the first table entry. </td></tr>
    <tr><td class="paramname">size</td><td>When <em>val</em> is lower than the last table entry. </td></tr>
    <tr><td class="paramname">1..size-1</td><td>When <em>val</em> is within the table. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ntc_8c_source.html#l00067">67</a> of file <a class="el" href="ntc_8c_source.html">ntc.c</a>.</p>

</div>
</div>
</div>


